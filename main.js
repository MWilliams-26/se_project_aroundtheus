!function(){"use strict";const e=[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}],t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"};var s=class{constructor(e,t,s){this._name=e.name,this._link=e.link,this._cardSelector=t,this._handlePreviewPicture=s}_getTemplate(){return document.querySelector(this._cardSelector).content.firstElementChild.cloneNode(!0)}_setEventListeners(){this._element.querySelector(".card__like-button").addEventListener("click",(()=>this._handleLikeButton())),this._element.querySelector(".card__delete-button").addEventListener("click",(()=>this._handleDeleteButton())),this._element.querySelector(".card__image").addEventListener("click",(()=>this._handlePreviewPicture({name:this._name,link:this._link})))}_handleLikeButton(){this._element.querySelector(".card__like-button").classList.toggle("card__like-button_active")}_handleDeleteButton(){this._element.remove(),this._element=null}generateCard(){return this._element=this._getTemplate(),this._setEventListeners(),this._cardImageEl=this._element.querySelector(".card__image"),this._cardTitleEl=this._element.querySelector(".card__title"),this._cardImageEl.src=this._link,this._cardImageEl.alt=this._name,this._cardTitleEl.textContent=this._name,this._element}},r=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formEl=t}_showInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return!this._inputEls.every((e=>e.validity.valid))}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_toggleButtonState(){this._hasInvalidInput(this._inputEls)?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_setEventListeners(){this._inputEls=[...this._formEl.querySelectorAll(this._inputSelector)],this._submitButton=this._formEl.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formEl.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputEls.forEach((e=>{this._hideInputError(e)}))}};class n{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}class i{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("click",(e=>{(e.target===this._popupElement||e.target.classList.contains("modal__close"))&&this.close()}))}}var o=class extends i{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputList=this._popupForm.querySelectorAll(".modal__input")}close(){this._popupForm.reset(),super.close()}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}};const a=document.querySelector("#profile-edit-modal"),l=document.querySelector("#profile-edit-button"),c=(a.querySelector(".modal__close"),document.forms["edit-profile-form"],document.querySelector("#profile-description-input")),d=document.querySelector("#profile-title-input"),u=(document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector("#profile-add-card-modal")),h=document.querySelector("#profile-add-button"),_=(u.querySelector(".modal__close"),document.forms["add-card-form"],u.querySelector(".modal__input_type_title"),u.querySelector(".modal__input_type_url"),document.querySelector("#image-preview-modal"));let m;_.querySelector(".modal__image-preview"),_.querySelector(".modal__image-caption"),_.querySelector(".modal__close"),document.querySelector("#card-template").content.firstElementChild,new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}loadUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"get",headers:this._headers}).then(this._checkResponse)}editProfileInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:title,about:description})}).then(this._checkResponse)}addCard(){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:title,link:url})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/_id`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}likeCard(){return fetch(`${this._baseUrl}/cards/_id/likes`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}unlikeCard(){return fetch(`${this._baseUrl}/cards/_id`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}unlikeCard(){return fetch(`${this._baseUrl}/cards/_id`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}editProfilePicture(){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:link})}).then(this._checkResponse)}loadPageContent(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"f34fc940-6444-4c84-9643-915e876889fb","Content-Type":"application/json"}}).getInitialCards().then((t=>{m=new n({items:e,renderer:e=>{const t=C(e);m.addItem(t)}},".cards__list"),m.renderItems()}));const p=new o("#profile-edit-modal",(function(e){y.setUserInfo(e.title,e.description),p.close()}));p.setEventListeners();const E=document.forms["edit-profile-form"],f=new r(t,E);f.enableValidation();const v=new o("#profile-add-card-modal",(function(e){const t=C({name:e.title,link:e.url});m.addItem(t),v.close()}));v.setEventListeners();const b=document.forms["add-card-form"],S=new r(t,b);S.enableValidation();const y=new class{constructor(e,t){this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo(e,t){this._nameElement.textContent=e,this._jobElement.textContent=t}}(".profile__title",".profile__description"),g=new class extends i{constructor(e){super({popupSelector:e}),this._image=this._popupElement.querySelector(".modal__image-preview"),this._caption=this._popupElement.querySelector(".modal__image-caption")}open(e,t){this._image.src=t,this._image.alt=e,this._caption.textContent=e,super.open()}}("#image-preview-modal");g.setEventListeners();const k={};function C(e){return new s(e,"#card-template",(()=>{g.open(e.name,e.link)})).generateCard()}(e=>{Array.from(document.querySelectorAll(e.formSelector)).forEach((t=>{const s=new r(e,t),n=t.getAttribute("name");k[n]=s,s.enableValidation()}))})(t),l.addEventListener("click",(()=>{f.resetValidation();const e=y.getUserInfo();d.value=e.name,c.value=e.job,p.open()})),h.addEventListener("click",(()=>{v.open(),S.resetValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFZRyxhQUFhLFFBRTFDUCxFQUFlTSxHQUFZRCxFQUM1QkEsRUFBVTNHLGtCQUFrQixHQUMzQixFQUdKQSxDQUFpQmpFLEdBdUJqQndHLEVBQWtCaEYsaUJBQWlCLFNBQVMsS0FDMUNrSSxFQUFrQnZGLGtCQUNsQixNQUFNNEcsRUFBV3hCLEVBQWdCTixjQUNqQ3RDLEVBQWtCTCxNQUFReUUsRUFBU2pMLEtBQ25DMkcsRUFBd0JILE1BQVF5RSxFQUFTWixJQUN6Q2QsRUFBcUJqRSxNQUFNLElBSTdCeUIsRUFBcUJyRixpQkFBaUIsU0FBUyxLQUM3Q29JLEVBQW9CeEUsT0FDcEIwRSxFQUFpQjNGLGlCQUFpQixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcclxuICB9LFxyXG5cclxuICB7XHJcbiAgICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcclxuICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxyXG4gIH0sXHJcblxyXG4gIHtcclxuICAgICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgfSxcclxuXHJcbiAge1xyXG4gICAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhdGVtYXIuanBnXCIsXHJcbiAgfSxcclxuXHJcbiAge1xyXG4gICAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4gICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcclxuICB9LFxyXG5cclxuICB7XHJcbiAgICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXHJcbiAgfVxyXG5dO1xyXG5cclxuXHJcbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uU2V0dGluZ3MgPSB7XHJcbiAgICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbiAgICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXHJcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcclxuICAgIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gICAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiXHJcbn07XHJcbiIsImNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKGNhcmREYXRhLCBjYXJkU2VsZWN0b3IsIGhhbmRsZVByZXZpZXdQaWN0dXJlKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gY2FyZERhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBjYXJkRGF0YS5saW5rO1xyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlUHJldmlld1BpY3R1cmUgPSBoYW5kbGVQcmV2aWV3UGljdHVyZTtcclxuICB9XHJcbiAgXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LmZpcnN0RWxlbWVudENoaWxkXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICByZXR1cm4gY2FyZEVsZW1lbnRcclxuICB9XHJcbiAgXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZUxpa2VCdXR0b24oKSk7XHJcblxyXG4gICAgdGhpcy5fZWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlRGVsZXRlQnV0dG9uKCkpO1xyXG5cclxuICAgIHRoaXMuX2VsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVQcmV2aWV3UGljdHVyZSh7IG5hbWU6IHRoaXMuX25hbWUsIGxpbms6IHRoaXMuX2xpbmsgfSkpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUxpa2VCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpXHJcbiAgICAgIC5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZURlbGV0ZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcclxuICB9XHJcbiAgICAgIFxyXG4gIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2NhcmRUaXRsZUVsID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xyXG4gICAgXHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWwuYWx0ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2NhcmRUaXRsZUVsLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcclxuICB9ICAgIFxyXG4gICAgXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IENhcmQ7IFxyXG4iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zLCBmb3JtRWwpIHtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBvcHRpb25zLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IG9wdGlvbnMuc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gb3B0aW9ucy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gb3B0aW9ucy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gb3B0aW9ucy5lcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZm9ybUVsID0gZm9ybUVsO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpIHtcclxuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7IFxyXG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpIHtcclxuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7IFxyXG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuICBcclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpIHtcclxuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgICB9IFxyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgIHJldHVybiAhdGhpcy5faW5wdXRFbHMuZXZlcnkoKGlucHV0RWwpID0+IGlucHV0RWwudmFsaWRpdHkudmFsaWQpO1xyXG4gIH1cclxuXHJcbiAgZGlzYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpXHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgX2VuYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgfVxyXG4gIFxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQodGhpcy5faW5wdXRFbHMpKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gIFxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW5wdXRFbHMgPSBbLi4udGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcildO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgICBcclxuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHtcclxuICAgICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKGUpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtRWwuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7IFxyXG4gIH1cclxuXHJcbiAgXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7IFxyXG5cclxuICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudClcclxuICB9KTtcclxuICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yOyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihjYXJkRGF0YSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG59IiwiXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH0gXHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkgeyBcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgZXZ0LnRhcmdldCA9PT0gdGhpcy5fcG9wdXBFbGVtZW50IHx8IFxyXG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlXCIpXHJcbiAgICAgICkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSlcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpXHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XHJcbiAgICBzdXBlci5jbG9zZSgpOyBcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgfSk7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoRm9ybVxyXG5cclxuLy9pbmRleC5qc1xyXG5cclxuLy8gY29uc3QgbmV3Q2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjcHJvZmlsZS1hZGQtY2FyZC1tb2RhbFwiLCAoKSA9PiB7fSk7XHJcbi8vIG5ld0NhcmRQb3B1cC5vcGVuXHJcblxyXG5cclxuLy8gbmV3Q2FyZFBvcHVwLmNsb3NlKCkiLCIvLyBJbXBvcnQgYWxsIHRoZSBjbGFzc2VzXHJcbmltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgeyBpbml0aWFsQ2FyZHMsIHZhbGlkYXRpb25TZXR0aW5ncyB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHNcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZFwiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb25cIjtcclxuaW1wb3J0IFBvcHVwIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm1cIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mb1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaVwiO1xyXG5cclxuXHJcbi8vIFByb2ZpbGUgRWRpdFxyXG5jb25zdCBwcm9maWxlRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtbW9kYWxcIik7XHJcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xyXG5jb25zdCBwcm9maWxlQ2xvc2VCdXR0b24gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xyXG5jb25zdCBwcm9maWxlRWRpdEZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcImVkaXQtcHJvZmlsZS1mb3JtXCJdO1xyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiKTtcclxuY29uc3QgcHJvZmlsZVRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtdGl0bGUtaW5wdXRcIik7XHJcbmNvbnN0IHByb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XHJcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XHJcblxyXG5cclxuLy8gQWRkIENhcmRcclxuY29uc3QgcHJvZmlsZUFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1hZGQtY2FyZC1tb2RhbFwiKTtcclxuY29uc3QgcHJvZmlsZUFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtYWRkLWJ1dHRvblwiKTtcclxuY29uc3QgcHJvZmlsZUFkZENhcmRDbG9zZUJ1dHRvbiA9IHByb2ZpbGVBZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XHJcbmNvbnN0IGFkZENhcmRGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJhZGQtY2FyZC1mb3JtXCJdO1xyXG5jb25zdCBwcm9maWxlQWRkQ2FyZFRpdGxlSW5wdXQgPSBwcm9maWxlQWRkQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2lucHV0X3R5cGVfdGl0bGVcIik7XHJcbmNvbnN0IHByb2ZpbGVBZGRDYXJkVXJsSW5wdXQgPSBwcm9maWxlQWRkQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2lucHV0X3R5cGVfdXJsXCIpO1xyXG5cclxuLy8gUHJldmlldyBJbWFnZSBNb2RhbFxyXG5jb25zdCBpbWFnZVByZXZpZXdNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjaW1hZ2UtcHJldmlldy1tb2RhbFwiKTtcclxuY29uc3QgbW9kYWxJbWFnZUVsZW1lbnQgPSBpbWFnZVByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZS1wcmV2aWV3XCIpO1xyXG5jb25zdCBtb2RhbENhcHRpb24gPSBpbWFnZVByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZS1jYXB0aW9uXCIpO1xyXG5jb25zdCBpbWFnZVByZXZpZXdDbG9zZUJ1dHRvbiA9IGltYWdlUHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xyXG5cclxuY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7XHJcblxyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiZjM0ZmM5NDAtNjQ0NC00Yzg0LTk2NDMtOTE1ZTg3Njg4OWZiXCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gIH1cclxufSk7IFxyXG5cclxubGV0IGNhcmRTZWN0aW9uO1xyXG5hcGkuZ2V0SW5pdGlhbENhcmRzKCkudGhlbigocmVzKSA9PiB7XHJcbiAgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbih7XHJcbiAgICBpdGVtczogaW5pdGlhbENhcmRzLFxyXG4gICAgcmVuZGVyZXI6IChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICBjb25zdCBjYXJkRWwgPSByZW5kZXJDYXJkKGNhcmREYXRhKTtcclxuICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRWwpO1xyXG4gICAgfSxcclxuICB9LCAgXHJcbiAgXCIuY2FyZHNfX2xpc3RcIlxyXG4gICk7XHJcbiAgXHJcbiAgY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoKTtcclxufSlcclxuXHJcblxyXG5jb25zdCBwcm9maWxlRWRpdEZvcm1Qb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLCBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdCk7XHJcbnByb2ZpbGVFZGl0Rm9ybVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBlZGl0Rm9ybUVsZW1lbnQgPSBkb2N1bWVudC5mb3Jtc1tcImVkaXQtcHJvZmlsZS1mb3JtXCJdO1xyXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgZWRpdEZvcm1FbGVtZW50KTtcclxuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuY29uc3QgcHJvZmlsZUFkZENhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI3Byb2ZpbGUtYWRkLWNhcmQtbW9kYWxcIiwgaGFuZGxlUHJvZmlsZUFkZENhcmRTdWJtaXQpO1xyXG5wcm9maWxlQWRkQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBhZGRGb3JtRWxlbWVudCA9IGRvY3VtZW50LmZvcm1zW1wiYWRkLWNhcmQtZm9ybVwiXTtcclxuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgYWRkRm9ybUVsZW1lbnQpO1xyXG5hZGRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVVc2VySW5mbyA9IG5ldyBVc2VySW5mbyhcIi5wcm9maWxlX190aXRsZVwiLCBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcclxuXHJcbmNvbnN0IHBvcHVwV2l0aEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI2ltYWdlLXByZXZpZXctbW9kYWxcIik7XHJcbnBvcHVwV2l0aEltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9XHJcblxyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKHZhbGlkYXRpb25TZXR0aW5ncykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHZhbGlkYXRpb25TZXR0aW5ncy5mb3JtU2VsZWN0b3IpKVxyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XHJcbiAgICBjb25zdCB2YWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uU2V0dGluZ3MsIGZvcm1FbGVtZW50KVxyXG4gICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpXHJcbiAgIFxyXG4gICAgZm9ybVZhbGlkYXRvcnNbZm9ybU5hbWVdID0gdmFsaWRhdG9yO1xyXG4gICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuZW5hYmxlVmFsaWRhdGlvbih2YWxpZGF0aW9uU2V0dGluZ3MpO1xyXG5cclxuXHJcbmZ1bmN0aW9uIHJlbmRlckNhcmQoY2FyZERhdGEpIHtcclxuICByZXR1cm4gbmV3IENhcmQoY2FyZERhdGEsIFwiI2NhcmQtdGVtcGxhdGVcIiwgKCkgPT4ge1xyXG4gICAgcG9wdXBXaXRoSW1hZ2Uub3BlbihjYXJkRGF0YS5uYW1lLCBjYXJkRGF0YS5saW5rKVxyXG4gIH0pXHJcbiAgLmdlbmVyYXRlQ2FyZCgpO1xyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQoaW5wdXRWYWx1ZXMpIHtcclxuICBwcm9maWxlVXNlckluZm8uc2V0VXNlckluZm8oaW5wdXRWYWx1ZXMudGl0bGUsIGlucHV0VmFsdWVzLmRlc2NyaXB0aW9uKTtcclxuICBwcm9maWxlRWRpdEZvcm1Qb3B1cC5jbG9zZSgpO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUFkZENhcmRTdWJtaXQoaW5wdXRWYWx1ZXMpIHtcclxuICBjb25zdCBjYXJkRGF0YSA9IHJlbmRlckNhcmQoe25hbWU6IGlucHV0VmFsdWVzLnRpdGxlLCBsaW5rOiBpbnB1dFZhbHVlcy51cmwgfSk7XHJcbiAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRGF0YSk7XHJcbiAgcHJvZmlsZUFkZENhcmRQb3B1cC5jbG9zZSgpO1xyXG4gIFxyXG59O1xyXG5cclxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBlZGl0Rm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxuICBjb25zdCB1c2VySW5mbyA9IHByb2ZpbGVVc2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIHByb2ZpbGVUaXRsZUlucHV0LnZhbHVlID0gdXNlckluZm8ubmFtZTtcclxuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHVzZXJJbmZvLmpvYjtcclxuICBwcm9maWxlRWRpdEZvcm1Qb3B1cC5vcGVuKCk7XHJcbiAgXHJcbn0pO1xyXG5cclxucHJvZmlsZUFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBwcm9maWxlQWRkQ2FyZFBvcHVwLm9wZW4oKTtcclxuICBhZGRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTsiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxuICBcclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwgXHJcbiAgICB7IGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcclxuICB9O1xyXG5cclxuICBsb2FkVXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCBcclxuICAgIHtcclxuICAgICAgbWV0aG9kOiBcImdldFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcclxuICB9O1xyXG5cclxuICBlZGl0UHJvZmlsZUluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCBcclxuICAgIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiB0aXRsZSxcclxuICAgICAgICBhYm91dDogZGVzY3JpcHRpb24sXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKSAgXHJcbiAgfTtcclxuXHJcbiAgYWRkQ2FyZCgpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIFxyXG4gICAge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogdGl0bGUsXHJcbiAgICAgICAgbGluazogdXJsLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcclxuICB9O1xyXG5cclxuICBkZWxldGVDYXJkKF9pZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL19pZGAsIFxyXG4gICAge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KVxyXG4gICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcclxuICB9O1xyXG5cclxuICBsaWtlQ2FyZCgpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9faWQvbGlrZXNgLCBcclxuICAgIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSlcclxuICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgfTtcclxuXHJcbiAgdW5saWtlQ2FyZCgpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9faWRgLCBcclxuICAgIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSlcclxuICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgfTtcclxuXHJcbiAgdW5saWtlQ2FyZCgpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9faWRgLCBcclxuICAgIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSlcclxuICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgfTtcclxuXHJcbiAgZWRpdFByb2ZpbGVQaWN0dXJlKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIFxyXG4gICAge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcjogbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpIFxyXG4gIH1cclxuXHJcbiAgbG9hZFBhZ2VDb250ZW50KCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldFVzZXJJbmZvKCksIHRoaXMuZ2V0SW5pdGlhbENhcmRzKCldKTtcclxuICB9XHJcblxyXG5cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IobmFtZVNlbGVjdG9yLCBqb2JTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9qb2JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XHJcbiAgfVxyXG4gIFxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgY29uc3QgdXNlckluZm8gPSB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgICBqb2I6IHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQsXHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIHVzZXJJbmZvO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8obmFtZSwgam9iKSB7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50ID0gam9iO1xyXG4gIH1cclxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pXHJcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZS1wcmV2aWV3XCIpO1xyXG4gICAgdGhpcy5fY2FwdGlvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZS1jYXB0aW9uXCIpO1xyXG4gIH1cclxuXHJcblxyXG4gIG9wZW4obmFtZSwgbGluaykge1xyXG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gbGluaztcclxuICAgIHRoaXMuX2ltYWdlLmFsdCA9IG5hbWU7XHJcbiAgICB0aGlzLl9jYXB0aW9uLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9IFxyXG59XHJcblxyXG4gIl0sIm5hbWVzIjpbImluaXRpYWxDYXJkcyIsIm5hbWUiLCJsaW5rIiwidmFsaWRhdGlvblNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJjb25zdHJ1Y3RvciIsImNhcmREYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlUHJldmlld1BpY3R1cmUiLCJ0aGlzIiwiX25hbWUiLCJfbGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlUHJldmlld1BpY3R1cmUiLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJjbG9uZU5vZGUiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfZWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlTGlrZUJ1dHRvbiIsIl9oYW5kbGVEZWxldGVCdXR0b24iLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJyZW1vdmUiLCJnZW5lcmF0ZUNhcmQiLCJfY2FyZEltYWdlRWwiLCJfY2FyZFRpdGxlRWwiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsIm9wdGlvbnMiLCJmb3JtRWwiLCJfaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiX2Zvcm1FbCIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWwiLCJlcnJvck1lc3NhZ2VFbCIsImlkIiwiYWRkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfaW5wdXRFbHMiLCJldmVyeSIsImRpc2FibGVCdXR0b24iLCJfc3VibWl0QnV0dG9uIiwiZGlzYWJsZWQiLCJfZW5hYmxlQnV0dG9uIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJlIiwiZW5hYmxlVmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwicmVzZXRWYWxpZGF0aW9uIiwiaW5wdXRFbGVtZW50IiwiU2VjdGlvbiIsIl9yZWYiLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50Iiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2dCIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfaW5wdXRMaXN0IiwicmVzZXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJwcm9maWxlRWRpdE1vZGFsIiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlRGVzY3JpcHRpb25JbnB1dCIsImZvcm1zIiwicHJvZmlsZVRpdGxlSW5wdXQiLCJwcm9maWxlQWRkQ2FyZE1vZGFsIiwicHJvZmlsZUFkZENhcmRCdXR0b24iLCJpbWFnZVByZXZpZXdNb2RhbCIsImNhcmRTZWN0aW9uIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJ0aGVuIiwibG9hZFVzZXJJbmZvIiwibWV0aG9kIiwiZWRpdFByb2ZpbGVJbmZvIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ0aXRsZSIsImFib3V0IiwiZGVzY3JpcHRpb24iLCJhZGRDYXJkIiwidXJsIiwiZGVsZXRlQ2FyZCIsIl9pZCIsImxpa2VDYXJkIiwidW5saWtlQ2FyZCIsImVkaXRQcm9maWxlUGljdHVyZSIsImF2YXRhciIsImxvYWRQYWdlQ29udGVudCIsImFsbCIsImdldFVzZXJJbmZvIiwiYXV0aG9yaXphdGlvbiIsImNhcmRFbCIsInJlbmRlckNhcmQiLCJwcm9maWxlRWRpdEZvcm1Qb3B1cCIsIlBvcHVwV2l0aEZvcm0iLCJwcm9maWxlVXNlckluZm8iLCJzZXRVc2VySW5mbyIsImVkaXRGb3JtRWxlbWVudCIsImVkaXRGb3JtVmFsaWRhdG9yIiwiRm9ybVZhbGlkYXRvciIsInByb2ZpbGVBZGRDYXJkUG9wdXAiLCJhZGRGb3JtRWxlbWVudCIsImFkZEZvcm1WYWxpZGF0b3IiLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsIl9uYW1lRWxlbWVudCIsIl9qb2JFbGVtZW50Iiwiam9iIiwicG9wdXBXaXRoSW1hZ2UiLCJfaW1hZ2UiLCJfY2FwdGlvbiIsImZvcm1WYWxpZGF0b3JzIiwiQ2FyZCIsIkFycmF5IiwiZnJvbSIsImZvcm1FbGVtZW50IiwidmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiLCJ1c2VySW5mbyJdLCJzb3VyY2VSb290IjoiIn0=