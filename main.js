!function(){"use strict";const e=[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}],t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"};var s=class{constructor(e,t,s){this._name=e.name,this._link=e.link,this._cardSelector=t,this._handlePreviewPicture=s}_getTemplate(){return document.querySelector(this._cardSelector).content.firstElementChild.cloneNode(!0)}_setEventListeners(){this._element.querySelector(".card__like-button").addEventListener("click",(()=>this._handleLikeButton())),this._element.querySelector(".card__delete-button").addEventListener("click",(()=>this._handleDeleteButton())),this._element.querySelector(".card__image").addEventListener("click",(()=>this._handlePreviewPicture({name:this._name,link:this._link})))}_handleLikeButton(){this._element.querySelector(".card__like-button").classList.toggle("card__like-button_active")}_handleDeleteButton(){this._element.remove(),this._element=null}generateCard(){return this._element=this._getTemplate(),this._setEventListeners(),this._cardImageEl=this._element.querySelector(".card__image"),this._cardTitleEl=this._element.querySelector(".card__title"),this._cardImageEl.src=this._link,this._cardImageEl.alt=this._name,this._cardTitleEl.textContent=this._name,this._element}},r=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formEl=t}_showInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return!this._inputEls.every((e=>e.validity.valid))}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_toggleButtonState(){this._hasInvalidInput(this._inputEls)?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_setEventListeners(){this._inputEls=[...this._formEl.querySelectorAll(this._inputSelector)],this._submitButton=this._formEl.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formEl.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputEls.forEach((e=>{this._hideInputError(e)}))}};class n{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}class i{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("click",(e=>{(e.target===this._popupElement||e.target.classList.contains("modal__close"))&&this.close()}))}}var o=class extends i{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputList=this._popupForm.querySelectorAll(".modal__input")}close(){this._popupForm.reset(),super.close()}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}};const a=document.querySelector("#profile-edit-modal"),l=document.querySelector("#profile-edit-button"),c=(a.querySelector(".modal__close"),document.forms["edit-profile-form"],document.querySelector("#profile-description-input")),d=document.querySelector("#profile-title-input"),u=(document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector("#profile-add-card-modal")),h=document.querySelector("#profile-add-button"),_=(u.querySelector(".modal__close"),document.forms["add-card-form"],u.querySelector(".modal__input_type_title"),u.querySelector(".modal__input_type_url"),document.querySelector("#image-preview-modal")),m=(_.querySelector(".modal__image-preview"),_.querySelector(".modal__image-caption"),_.querySelector(".modal__close"),document.querySelector("#card-template").content.firstElementChild,new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}loadUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"get",headers:this._headers}).then(this._checkResponse)}editProfileInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:title,about:description})}).then(this._checkResponse)}addCard(){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:title,link:url})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/_id`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}likeCard(){return fetch(`${this._baseUrl}/cards/_id/likes`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}unlikeCard(){return fetch(`${this._baseUrl}/cards/_id`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}unlikeCard(){return fetch(`${this._baseUrl}/cards/_id`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}editProfilePicture(){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:link})}).then(this._checkResponse)}loadPageContent(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"f34fc940-6444-4c84-9643-915e876889fb","Content-Type":"application/json"}}));let p;const E=new class{constructor(e,t){this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo(e,t){this._nameElement.textContent=e,this._jobElement.textContent=t}}(".profile__title",".profile__description");m.loadPageContent().then((t=>{p=new n({items:e,renderer:e=>{const t=L(e);p.addItem(t)}},".cards__list"),p.renderItems()})).catch((e=>{console.error(e)}));const f=new o("#profile-edit-modal",(function(e){E.setUserInfo(e.title,e.description),f.close()}));f.setEventListeners();const v=document.forms["edit-profile-form"],b=new r(t,v);b.enableValidation();const S=new o("#profile-add-card-modal",(function(e){const t=L({name:e.title,link:e.url});p.addItem(t),S.close()}));S.setEventListeners();const y=document.forms["add-card-form"],g=new r(t,y);g.enableValidation();const k=new class extends i{constructor(e){super({popupSelector:e}),this._image=this._popupElement.querySelector(".modal__image-preview"),this._caption=this._popupElement.querySelector(".modal__image-caption")}open(e,t){this._image.src=t,this._image.alt=e,this._caption.textContent=e,super.open()}}("#image-preview-modal");k.setEventListeners();const C={};function L(e){return new s(e,"#card-template",(()=>{k.open(e.name,e.link)})).generateCard()}(e=>{Array.from(document.querySelectorAll(e.formSelector)).forEach((t=>{const s=new r(e,t),n=t.getAttribute("name");C[n]=s,s.enableValidation()}))})(t),l.addEventListener("click",(()=>{b.resetValidation();const e=E.getUserInfo();d.value=e.name,c.value=e.job,f.open()})),h.addEventListener("click",(()=>{S.open(),g.resetValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNoQixNQUFNQyxFQUFZLElBQUlaLEVBQWNySyxFQUFvQmdMLEdBQ2xERSxFQUFXRixFQUFZRyxhQUFhLFFBRTFDUCxFQUFlTSxHQUFZRCxFQUM1QkEsRUFBVWhILGtCQUFrQixHQUMzQixFQUdKQSxDQUFpQmpFLEdBdUJqQndHLEVBQWtCaEYsaUJBQWlCLFNBQVMsS0FDMUM0SSxFQUFrQmpHLGtCQUNsQixNQUFNaUgsRUFBV2hDLEVBQWdCSCxjQUNqQ3RDLEVBQWtCTCxNQUFROEUsRUFBU3RMLEtBQ25DMkcsRUFBd0JILE1BQVE4RSxFQUFTM0IsSUFDekNRLEVBQXFCN0UsTUFBTSxJQUk3QnlCLEVBQXFCckYsaUJBQWlCLFNBQVMsS0FDN0M4SSxFQUFvQmxGLE9BQ3BCb0YsRUFBaUJyRyxpQkFBaUIsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAge1xyXG4gICAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4gICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuXHJcbiAge1xyXG4gICAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcclxuICB9LFxyXG5cclxuICB7XHJcbiAgICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gIH0sXHJcblxyXG4gIHtcclxuICAgICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxyXG4gIH0sXHJcblxyXG4gIHtcclxuICAgICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXHJcbiAgfSxcclxuXHJcbiAge1xyXG4gICAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxyXG4gIH1cclxuXTtcclxuXHJcblxyXG5leHBvcnQgY29uc3QgdmFsaWRhdGlvblNldHRpbmdzID0ge1xyXG4gICAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gICAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxyXG4gICAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICAgIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIlxyXG59O1xyXG4iLCJjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihjYXJkRGF0YSwgY2FyZFNlbGVjdG9yLCBoYW5kbGVQcmV2aWV3UGljdHVyZSkge1xyXG4gICAgdGhpcy5fbmFtZSA9IGNhcmREYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gY2FyZERhdGEubGluaztcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZVByZXZpZXdQaWN0dXJlID0gaGFuZGxlUHJldmlld1BpY3R1cmU7XHJcbiAgfVxyXG4gIFxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZFxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50XHJcbiAgfVxyXG4gIFxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2VsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKCkpO1xyXG5cclxuICAgIHRoaXMuX2VsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZURlbGV0ZUJ1dHRvbigpKTtcclxuXHJcbiAgICB0aGlzLl9lbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlUHJldmlld1BpY3R1cmUoeyBuYW1lOiB0aGlzLl9uYW1lLCBsaW5rOiB0aGlzLl9saW5rIH0pKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVMaWtlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKVxyXG4gICAgICAuY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVEZWxldGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XHJcbiAgfVxyXG4gICAgICBcclxuICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgdGhpcy5fY2FyZEltYWdlRWwgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9jYXJkVGl0bGVFbCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuICAgIFxyXG4gICAgdGhpcy5fY2FyZEltYWdlRWwuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsLmFsdCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9jYXJkVGl0bGVFbC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgfSAgICBcclxuICAgIFxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBDYXJkOyBcclxuIiwiY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Iob3B0aW9ucywgZm9ybUVsKSB7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gb3B0aW9ucy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBvcHRpb25zLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IG9wdGlvbnMuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IG9wdGlvbnMuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IG9wdGlvbnMuZXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Zvcm1FbCA9IGZvcm1FbDtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsKSB7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApOyBcclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApOyBcclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcbiAgXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XHJcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgfSBcclxuICB9XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gIXRoaXMuX2lucHV0RWxzLmV2ZXJ5KChpbnB1dEVsKSA9PiBpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKTtcclxuICB9XHJcblxyXG4gIGRpc2FibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKVxyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIF9lbmFibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxuICBcclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0RWxzKSkge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICBcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0RWxzID0gWy4uLnRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICAgICAgXHJcbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XHJcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChlKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpOyBcclxuICB9XHJcblxyXG4gIFxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpOyBcclxuXHJcbiAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpXHJcbiAgfSk7XHJcbiAgfVxyXG5cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjsiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoY2FyZERhdGEpID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIoY2FyZERhdGEpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxufSIsIlxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9IFxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHsgXHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgICAgaWYgKFxyXG4gICAgICAgIGV2dC50YXJnZXQgPT09IHRoaXMuX3BvcHVwRWxlbWVudCB8fCBcclxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZVwiKVxyXG4gICAgICApIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pXHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKVxyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIik7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xyXG4gICAgc3VwZXIuY2xvc2UoKTsgXHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGlucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgIH0pO1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEZvcm1cclxuXHJcbi8vaW5kZXguanNcclxuXHJcbi8vIGNvbnN0IG5ld0NhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI3Byb2ZpbGUtYWRkLWNhcmQtbW9kYWxcIiwgKCkgPT4ge30pO1xyXG4vLyBuZXdDYXJkUG9wdXAub3BlblxyXG5cclxuXHJcbi8vIG5ld0NhcmRQb3B1cC5jbG9zZSgpIiwiLy8gSW1wb3J0IGFsbCB0aGUgY2xhc3Nlc1xyXG5pbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcclxuaW1wb3J0IHsgaW5pdGlhbENhcmRzLCB2YWxpZGF0aW9uU2V0dGluZ3MgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmRcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvclwiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uXCI7XHJcbmltcG9ydCBQb3B1cCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFwiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZVwiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm9cIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGlcIjtcclxuXHJcblxyXG4vLyBQcm9maWxlIEVkaXRcclxuY29uc3QgcHJvZmlsZUVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIpO1xyXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LWJ1dHRvblwiKTtcclxuY29uc3QgcHJvZmlsZUNsb3NlQnV0dG9uID0gcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcclxuY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJlZGl0LXByb2ZpbGUtZm9ybVwiXTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIik7XHJcbmNvbnN0IHByb2ZpbGVUaXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXRpdGxlLWlucHV0XCIpO1xyXG5jb25zdCBwcm9maWxlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RpdGxlXCIpO1xyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xyXG5cclxuXHJcbi8vIEFkZCBDYXJkXHJcbmNvbnN0IHByb2ZpbGVBZGRDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtYWRkLWNhcmQtbW9kYWxcIik7XHJcbmNvbnN0IHByb2ZpbGVBZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWFkZC1idXR0b25cIik7XHJcbmNvbnN0IHByb2ZpbGVBZGRDYXJkQ2xvc2VCdXR0b24gPSBwcm9maWxlQWRkQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xyXG5jb25zdCBhZGRDYXJkRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiYWRkLWNhcmQtZm9ybVwiXTtcclxuY29uc3QgcHJvZmlsZUFkZENhcmRUaXRsZUlucHV0ID0gcHJvZmlsZUFkZENhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbnB1dF90eXBlX3RpdGxlXCIpO1xyXG5jb25zdCBwcm9maWxlQWRkQ2FyZFVybElucHV0ID0gcHJvZmlsZUFkZENhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbnB1dF90eXBlX3VybFwiKTtcclxuXHJcbi8vIFByZXZpZXcgSW1hZ2UgTW9kYWxcclxuY29uc3QgaW1hZ2VQcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2ltYWdlLXByZXZpZXctbW9kYWxcIik7XHJcbmNvbnN0IG1vZGFsSW1hZ2VFbGVtZW50ID0gaW1hZ2VQcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2UtcHJldmlld1wiKTtcclxuY29uc3QgbW9kYWxDYXB0aW9uID0gaW1hZ2VQcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2UtY2FwdGlvblwiKTtcclxuY29uc3QgaW1hZ2VQcmV2aWV3Q2xvc2VCdXR0b24gPSBpbWFnZVByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcclxuXHJcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKS5jb250ZW50LmZpcnN0RWxlbWVudENoaWxkO1xyXG5cclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcImYzNGZjOTQwLTY0NDQtNGM4NC05NjQzLTkxNWU4NzY4ODlmYlwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcclxuICB9XHJcbn0pOyBcclxuXHJcbmxldCBjYXJkU2VjdGlvbjtcclxuXHJcbmNvbnN0IHByb2ZpbGVVc2VySW5mbyA9IG5ldyBVc2VySW5mbyhcIi5wcm9maWxlX190aXRsZVwiLCBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcclxuXHJcbmFwaVxyXG4gIC5sb2FkUGFnZUNvbnRlbnQoKVxyXG4gIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbih7XHJcbiAgICBpdGVtczogaW5pdGlhbENhcmRzLFxyXG4gICAgcmVuZGVyZXI6IChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICBjb25zdCBjYXJkRWwgPSByZW5kZXJDYXJkKGNhcmREYXRhKTtcclxuICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRWwpO1xyXG4gICAgfSxcclxuICB9LCAgXHJcbiAgXCIuY2FyZHNfX2xpc3RcIlxyXG4gICk7XHJcbiAgXHJcbiAgY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgY29uc29sZS5lcnJvcihlcnIpOyBcclxuICB9KTtcclxuICBcclxuXHJcbmNvbnN0IHByb2ZpbGVFZGl0Rm9ybVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIsIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0KTtcclxucHJvZmlsZUVkaXRGb3JtUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IGVkaXRGb3JtRWxlbWVudCA9IGRvY3VtZW50LmZvcm1zW1wiZWRpdC1wcm9maWxlLWZvcm1cIl07XHJcbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBlZGl0Rm9ybUVsZW1lbnQpO1xyXG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5jb25zdCBwcm9maWxlQWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjcHJvZmlsZS1hZGQtY2FyZC1tb2RhbFwiLCBoYW5kbGVQcm9maWxlQWRkQ2FyZFN1Ym1pdCk7XHJcbnByb2ZpbGVBZGRDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IGFkZEZvcm1FbGVtZW50ID0gZG9jdW1lbnQuZm9ybXNbXCJhZGQtY2FyZC1mb3JtXCJdO1xyXG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBhZGRGb3JtRWxlbWVudCk7XHJcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuXHJcbmNvbnN0IHBvcHVwV2l0aEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI2ltYWdlLXByZXZpZXctbW9kYWxcIik7XHJcbnBvcHVwV2l0aEltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9XHJcblxyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKHZhbGlkYXRpb25TZXR0aW5ncykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHZhbGlkYXRpb25TZXR0aW5ncy5mb3JtU2VsZWN0b3IpKVxyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XHJcbiAgICBjb25zdCB2YWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uU2V0dGluZ3MsIGZvcm1FbGVtZW50KVxyXG4gICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpXHJcbiAgIFxyXG4gICAgZm9ybVZhbGlkYXRvcnNbZm9ybU5hbWVdID0gdmFsaWRhdG9yO1xyXG4gICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuZW5hYmxlVmFsaWRhdGlvbih2YWxpZGF0aW9uU2V0dGluZ3MpO1xyXG5cclxuXHJcbmZ1bmN0aW9uIHJlbmRlckNhcmQoY2FyZERhdGEpIHtcclxuICByZXR1cm4gbmV3IENhcmQoY2FyZERhdGEsIFwiI2NhcmQtdGVtcGxhdGVcIiwgKCkgPT4ge1xyXG4gICAgcG9wdXBXaXRoSW1hZ2Uub3BlbihjYXJkRGF0YS5uYW1lLCBjYXJkRGF0YS5saW5rKVxyXG4gIH0pXHJcbiAgLmdlbmVyYXRlQ2FyZCgpO1xyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQoaW5wdXRWYWx1ZXMpIHtcclxuICBwcm9maWxlVXNlckluZm8uc2V0VXNlckluZm8oaW5wdXRWYWx1ZXMudGl0bGUsIGlucHV0VmFsdWVzLmRlc2NyaXB0aW9uKTtcclxuICBwcm9maWxlRWRpdEZvcm1Qb3B1cC5jbG9zZSgpO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUFkZENhcmRTdWJtaXQoaW5wdXRWYWx1ZXMpIHtcclxuICBjb25zdCBjYXJkRGF0YSA9IHJlbmRlckNhcmQoe25hbWU6IGlucHV0VmFsdWVzLnRpdGxlLCBsaW5rOiBpbnB1dFZhbHVlcy51cmwgfSk7XHJcbiAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRGF0YSk7XHJcbiAgcHJvZmlsZUFkZENhcmRQb3B1cC5jbG9zZSgpO1xyXG4gIFxyXG59O1xyXG4gXHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZWRpdEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgY29uc3QgdXNlckluZm8gPSBwcm9maWxlVXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBwcm9maWxlVGl0bGVJbnB1dC52YWx1ZSA9IHVzZXJJbmZvLm5hbWU7XHJcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSB1c2VySW5mby5qb2I7XHJcbiAgcHJvZmlsZUVkaXRGb3JtUG9wdXAub3BlbigpO1xyXG4gIFxyXG59KTtcclxuXHJcbnByb2ZpbGVBZGRDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgcHJvZmlsZUFkZENhcmRQb3B1cC5vcGVuKCk7XHJcbiAgYWRkRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxufSk7IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9XHJcbiAgXHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIFxyXG4gICAgeyBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLCB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgfTtcclxuXHJcbiAgbG9hZFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwgXHJcbiAgICB7XHJcbiAgICAgIG1ldGhvZDogXCJnZXRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyx9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgfTtcclxuXHJcbiAgZWRpdFByb2ZpbGVJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwgXHJcbiAgICB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogdGl0bGUsXHJcbiAgICAgICAgYWJvdXQ6IGRlc2NyaXB0aW9uLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSkgIFxyXG4gIH07XHJcblxyXG4gIGFkZENhcmQoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCBcclxuICAgIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IHRpdGxlLFxyXG4gICAgICAgIGxpbms6IHVybCxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgfTtcclxuXHJcbiAgZGVsZXRlQ2FyZChfaWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9faWRgLCBcclxuICAgIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSlcclxuICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgfTtcclxuXHJcbiAgbGlrZUNhcmQoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvX2lkL2xpa2VzYCwgXHJcbiAgICB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pXHJcbiAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gIH07XHJcblxyXG4gIHVubGlrZUNhcmQoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvX2lkYCwgXHJcbiAgICB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pXHJcbiAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gIH07XHJcblxyXG4gIHVubGlrZUNhcmQoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvX2lkYCwgXHJcbiAgICB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pXHJcbiAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gIH07XHJcblxyXG4gIGVkaXRQcm9maWxlUGljdHVyZSgpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCBcclxuICAgIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXI6IGxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKSBcclxuICB9XHJcblxyXG4gIGxvYWRQYWdlQ29udGVudCgpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRVc2VySW5mbygpLCB0aGlzLmdldEluaXRpYWxDYXJkcygpXSk7XHJcbiAgfVxyXG5cclxuXHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fam9iRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xyXG4gIH1cclxuICBcclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIGNvbnN0IHVzZXJJbmZvID0ge1xyXG4gICAgICBuYW1lOiB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCxcclxuICAgICAgam9iOiB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgfTtcclxuICAgIHJldHVybiB1c2VySW5mbztcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKG5hbWUsIGpvYikge1xyXG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCA9IGpvYjtcclxuICB9XHJcbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KVxyXG4gICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2UtcHJldmlld1wiKTtcclxuICAgIHRoaXMuX2NhcHRpb24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2UtY2FwdGlvblwiKTtcclxuICB9XHJcblxyXG5cclxuICBvcGVuKG5hbWUsIGxpbmspIHtcclxuICAgIHRoaXMuX2ltYWdlLnNyYyA9IGxpbms7XHJcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSBuYW1lO1xyXG4gICAgdGhpcy5fY2FwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfSBcclxufVxyXG5cclxuICJdLCJuYW1lcyI6WyJpbml0aWFsQ2FyZHMiLCJuYW1lIiwibGluayIsInZhbGlkYXRpb25TZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiY29uc3RydWN0b3IiLCJjYXJkRGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZVByZXZpZXdQaWN0dXJlIiwidGhpcyIsIl9uYW1lIiwiX2xpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZVByZXZpZXdQaWN0dXJlIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImZpcnN0RWxlbWVudENoaWxkIiwiY2xvbmVOb2RlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2VsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiX2hhbmRsZUxpa2VCdXR0b24iLCJfaGFuZGxlRGVsZXRlQnV0dG9uIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwicmVtb3ZlIiwiZ2VuZXJhdGVDYXJkIiwiX2NhcmRJbWFnZUVsIiwiX2NhcmRUaXRsZUVsIiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJvcHRpb25zIiwiZm9ybUVsIiwiX2lucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsIl9mb3JtRWwiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsIiwiZXJyb3JNZXNzYWdlRWwiLCJpZCIsImFkZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGFzSW52YWxpZElucHV0IiwiX2lucHV0RWxzIiwiZXZlcnkiLCJkaXNhYmxlQnV0dG9uIiwiX3N1Ym1pdEJ1dHRvbiIsImRpc2FibGVkIiwiX2VuYWJsZUJ1dHRvbiIsIl90b2dnbGVCdXR0b25TdGF0ZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiZSIsImVuYWJsZVZhbGlkYXRpb24iLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0VmFsaWRhdGlvbiIsImlucHV0RWxlbWVudCIsIlNlY3Rpb24iLCJfcmVmIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIm9wZW4iLCJfaGFuZGxlRXNjQ2xvc2UiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2lucHV0TGlzdCIsInJlc2V0IiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRWYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwicHJvZmlsZUVkaXRNb2RhbCIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJmb3JtcyIsInByb2ZpbGVUaXRsZUlucHV0IiwicHJvZmlsZUFkZENhcmRNb2RhbCIsInByb2ZpbGVBZGRDYXJkQnV0dG9uIiwiaW1hZ2VQcmV2aWV3TW9kYWwiLCJhcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsInRoZW4iLCJsb2FkVXNlckluZm8iLCJtZXRob2QiLCJlZGl0UHJvZmlsZUluZm8iLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInRpdGxlIiwiYWJvdXQiLCJkZXNjcmlwdGlvbiIsImFkZENhcmQiLCJ1cmwiLCJkZWxldGVDYXJkIiwiX2lkIiwibGlrZUNhcmQiLCJ1bmxpa2VDYXJkIiwiZWRpdFByb2ZpbGVQaWN0dXJlIiwiYXZhdGFyIiwibG9hZFBhZ2VDb250ZW50IiwiYWxsIiwiZ2V0VXNlckluZm8iLCJhdXRob3JpemF0aW9uIiwiY2FyZFNlY3Rpb24iLCJwcm9maWxlVXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsIl9uYW1lRWxlbWVudCIsIl9qb2JFbGVtZW50Iiwiam9iIiwic2V0VXNlckluZm8iLCJjYXJkRWwiLCJyZW5kZXJDYXJkIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJwcm9maWxlRWRpdEZvcm1Qb3B1cCIsIlBvcHVwV2l0aEZvcm0iLCJlZGl0Rm9ybUVsZW1lbnQiLCJlZGl0Rm9ybVZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiLCJwcm9maWxlQWRkQ2FyZFBvcHVwIiwiYWRkRm9ybUVsZW1lbnQiLCJhZGRGb3JtVmFsaWRhdG9yIiwicG9wdXBXaXRoSW1hZ2UiLCJfaW1hZ2UiLCJfY2FwdGlvbiIsImZvcm1WYWxpZGF0b3JzIiwiQ2FyZCIsIkFycmF5IiwiZnJvbSIsImZvcm1FbGVtZW50IiwidmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiLCJ1c2VySW5mbyJdLCJzb3VyY2VSb290IjoiIn0=