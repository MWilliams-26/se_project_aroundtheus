!function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"};var t=class{constructor(e,t,s,i,r){this._name=e.name,this._link=e.link,this._id=e._id,this._isLiked=e.isLiked,this._cardSelector=t,this._handlePreviewPicture=s,this._handleDeleteClick=i,this._handleLikeClick=r}_getTemplate(){return document.querySelector(this._cardSelector).content.firstElementChild.cloneNode(!0)}_setEventListeners(){this._cardImageEl.addEventListener("click",(()=>{this._handlePreviewPicture(this._name,this._link)})),this._deleteButton=this._element.querySelector(".card__delete-button"),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteClick(this)})),this._likeButton.addEventListener("click",(()=>{this._handleLikeClick(this)}))}_handleLikeButton(){this._element.querySelector(".card__like-button").classList.toggle("card__like-button_active")}_updateLikeStatus(){this._isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}handleDeleteClick(){this._element.remove(),this._element=null}generateCard(){return this._element=this._getTemplate(),this._cardImageEl=this._element.querySelector(".card__image"),this._cardTitleEl=this._element.querySelector(".card__title"),this._cardImageEl.src=this._link,this._cardImageEl.alt=this._name,this._cardTitleEl.textContent=this._name,this._deleteButton=this._element.querySelector(".card__delete-button"),this._likeButton=this._element.querySelector(".card__like-button"),this._setEventListeners(),this._element}},s=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formEl=t}_showInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return!this._inputEls.every((e=>e.validity.valid))}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_toggleButtonState(){this._hasInvalidInput(this._inputEls)?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_setEventListeners(){this._inputEls=[...this._formEl.querySelectorAll(this._inputSelector)],this._submitButton=this._formEl.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formEl.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputEls.forEach((e=>{this._hideInputError(e)}))}};class i{constructor(e,t){let{items:s,renderer:i}=e;this._items=s,this._renderer=i,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}class r{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("click",(e=>{(e.target===this._popupElement||e.target.classList.contains("modal__close"))&&this.close()}))}}var n=class extends r{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputList=this._popupForm.querySelectorAll(".modal__input"),this._submitButton=this._popupForm.querySelector(".modal__button")}close(){this._popupForm.reset(),super.close()}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setLoading(e){this._submitButton.textContent=e?"Saving...":this._submitButtonText}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}};const o=document.querySelector("#profile-edit-modal"),l=document.querySelector("#profile-edit-button"),a=document.querySelector("#profile-avatar-button"),c=(o.querySelector(".modal__close"),o.querySelector(".modal__form_edit"),document.querySelector("#profile-description-input")),d=document.querySelector("#profile-title-input"),_=(document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector("#profile-add-card-modal")),u=document.querySelector("#profile-add-button"),h=(_.querySelector(".modal__close"),_.querySelector(".modal__form_add"),_.querySelector(".modal__input_type_title"),_.querySelector(".modal__input_type_url"),document.querySelector("#image-preview-modal")),m=(h.querySelector(".modal__image-preview"),h.querySelector(".modal__image-caption"),h.querySelector(".modal__close"),document.querySelector("#confirm-delete-modal").querySelector("#confirm-delete-submit"),document.querySelector("#avatar-edit-modal")),p=(document.querySelector("#card-template").content.firstElementChild,new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}loadUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then(this._checkResponse)}editProfileInfo(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.title,about:e.description})}).then(this._checkResponse)}addCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.title,link:e.url})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}unlikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}editProfilePicture(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}loadPageContent(){return Promise.all([this.loadUserInfo(),this.getInitialCards()])}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"f34fc940-6444-4c84-9643-915e876889fb","Content-Type":"application/json"}}));let E;p.getInitialCards().then((e=>{E=new i({items:e,renderer:e=>{const t=L(e);E.addItem(t)}},".cards__list"),E.renderItems()})).catch((e=>{console.error(e)}));const v=new class{constructor(e,t,s){this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t),this._avatarElement=document.querySelector(s)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo(e,t){this._nameElement.textContent=e,this._jobElement.textContent=t}setUserAvatar(e){this._avatarElement.src=e}}(".profile__title",".profile__description",".profile__image"),S=new s(e,o.querySelector(".modal__form_edit"));S.enableValidation(),new s(e,m.querySelector(".modal__form_avatar")).enableValidation();const b=new s(e,_.querySelector(".modal__form_add"));b.enableValidation();const f=new class extends r{constructor(e){super({popupSelector:e}),this._image=this._popupElement.querySelector(".modal__image-preview"),this._caption=this._popupElement.querySelector(".modal__image-caption")}open(e,t){this._image.src=t,this._image.alt=e,this._caption.textContent=e,super.open()}}("#image-preview-modal");function y(e,t){f.open(e,t)}function L(e){return new t(e,"#card-template",y,B,I).generateCard()}f.setEventListeners();const k=new n("#profile-edit-modal",(function(e){k.setLoading(!0),p.editProfileInfo(e).then((t=>{v.setUserInfo(e.title,e.description),k.close()})).catch((e=>{console.error(e)})).finally((()=>{k.setLoading(!1)}))}));k.setEventListeners();const C=new n("#profile-add-card-modal",(function(e){C.setLoading(!0),p.addCard(e).then((t=>{const s=L({name:e.title,link:e.url});E.addItem(s),C.close()})).catch((e=>{console.error(e)})).finally((()=>{C.setLoading(!1)}))}));C.setEventListeners();const g=new n("#avatar-edit-modal",(function(e){g.setLoading(!0),p.editProfilePicture(e.link).then((e=>{v.setUserAvatar(e.avatar),g.close()})).catch((e=>{console.error(e)})).finally((()=>{g.setLoading(!1)}))}));g.setEventListeners(),l.addEventListener("click",(()=>{S.resetValidation();const e=v.getUserInfo();d.value=e.name,c.value=e.job,k.open()})),u.addEventListener("click",(()=>{C.open(),b.resetValidation()})),a.addEventListener("click",(()=>{g.open()}));const q=new class extends r{constructor(e){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._submitButton=this._popupForm.querySelector(".modal__button")}setSubmitAction(e){this._handleFormSubmit=e}setLoading(){isLoading?this._submitButton.textContent="Deleting...":this._submitButton.textContent=this._submitButtonText}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{this._handleFormSubmit()})),super.setEventListeners()}}("#confirm-delete-modal");function B(e){q.open(),q.setSubmitAction((()=>{p.deleteCard(e._id).then((()=>{e.handleDeleteClick(),q.close()})).catch((e=>{console.error(e)}))}))}function I(e){e.isLiked?p.likeCard(e._id).then((t=>{e.handleLikeClick()})).catch((e=>{console.error(e)})):p.unlikeCard(e._id).then((t=>{e.handleLikeClick()})).catch((e=>{console.error(e)}))}q.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVN3QyxFQUFLaEwsS0FDZDBILE1BQU1SLElBQ0w4RCxFQUFLdEwsaUJBQWlCLElBRXZCd0osT0FBT0MsSUFDTkMsUUFBUUMsTUFBTUYsRUFBSSxJQUdwQnZDLEVBQ0M2QixXQUFXdUMsRUFBS2hMLEtBQ2hCMEgsTUFBTVIsSUFDTDhELEVBQUt0TCxpQkFBaUIsSUFFdkJ3SixPQUFPQyxJQUNOQyxRQUFRQyxNQUFNRixFQUFJLEdBR3hCLENBdkNBMkIsRUFBYzNGLG1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAge1xyXG4gICAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4gICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuXHJcbiAge1xyXG4gICAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcclxuICB9LFxyXG5cclxuICB7XHJcbiAgICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gIH0sXHJcblxyXG4gIHtcclxuICAgICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxyXG4gIH0sXHJcblxyXG4gIHtcclxuICAgICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXHJcbiAgfSxcclxuXHJcbiAge1xyXG4gICAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxyXG4gIH1cclxuXTtcclxuXHJcblxyXG5leHBvcnQgY29uc3QgdmFsaWRhdGlvblNldHRpbmdzID0ge1xyXG4gICAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gICAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxyXG4gICAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICAgIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIlxyXG59O1xyXG4iLCJjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihjYXJkRGF0YSwgY2FyZFNlbGVjdG9yLCBoYW5kbGVQcmV2aWV3UGljdHVyZSwgaGFuZGxlRGVsZXRlQ2xpY2ssIGhhbmRsZUxpa2VDbGljaykgXHJcbiAge1xyXG4gICAgdGhpcy5fbmFtZSA9IGNhcmREYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gY2FyZERhdGEubGluaztcclxuICAgIHRoaXMuX2lkID0gY2FyZERhdGEuX2lkO1xyXG4gICAgdGhpcy5faXNMaWtlZCA9IGNhcmREYXRhLmlzTGlrZWRcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZVByZXZpZXdQaWN0dXJlID0gaGFuZGxlUHJldmlld1BpY3R1cmU7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xyXG4gIH1cclxuICBcclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGRcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuICAgIHJldHVybiBjYXJkRWxlbWVudFxyXG4gIH1cclxuICBcclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZVByZXZpZXdQaWN0dXJlKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIik7XHJcbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcyk7XHJcbiAgICB9KTsgXHJcblxyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sodGhpcyk7XHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICBfaGFuZGxlTGlrZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX2VsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcclxuICAgICAgLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgfSAgXHJcblxyXG4gIF91cGRhdGVMaWtlU3RhdHVzKCkge1xyXG4gICAgaWYgKHRoaXMuX2lzTGlrZWQpIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgaGFuZGxlRGVsZXRlQ2xpY2soKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XHJcbiAgfVxyXG4gIFxyXG4gICAgICBcclxuICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgIFxyXG4gICAgdGhpcy5fY2FyZEltYWdlRWwgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9jYXJkVGl0bGVFbCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuICAgIFxyXG4gICAgdGhpcy5fY2FyZEltYWdlRWwuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsLmFsdCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9jYXJkVGl0bGVFbC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICBcclxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICAgXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gIH0gXHJcbiAgICBcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQ2FyZDsgXHJcbiIsImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMsIGZvcm1FbCkge1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IG9wdGlvbnMuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gb3B0aW9ucy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBvcHRpb25zLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBvcHRpb25zLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBvcHRpb25zLmVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9mb3JtRWwgPSBmb3JtRWw7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbCkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTsgXHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbCkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTsgXHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG4gIFxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCkge1xyXG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcclxuICAgIH0gXHJcbiAgfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuICF0aGlzLl9pbnB1dEVscy5ldmVyeSgoaW5wdXRFbCkgPT4gaW5wdXRFbC52YWxpZGl0eS52YWxpZCk7XHJcbiAgfVxyXG5cclxuICBkaXNhYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcylcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgfVxyXG5cclxuICBfZW5hYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICB9XHJcbiAgXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dEVscykpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dEVscyA9IFsuLi50aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKV07XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgICAgIFxyXG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoZSkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm1FbC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTsgXHJcbiAgfVxyXG5cclxuICBcclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTsgXHJcblxyXG4gIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KVxyXG4gIH0pO1xyXG4gIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICByZW5kZXJJdGVtcygpIHtcclxuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGNhcmREYXRhKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGNhcmREYXRhKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn0iLCJcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfSBcclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT4ge1xyXG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7IFxyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGlmIChcclxuICAgICAgICBldnQudGFyZ2V0ID09PSB0aGlzLl9wb3B1cEVsZW1lbnQgfHwgXHJcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2VcIilcclxuICAgICAgKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5jbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KVxyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIilcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcclxuICAgXHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xyXG4gICAgc3VwZXIuY2xvc2UoKTsgXHJcbiAgfVxyXG4gIFxyXG4gIFxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xyXG4gIH0gXHJcblxyXG4gIHNldExvYWRpbmcoaXNMb2FkaW5nKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdXR0b25UZXh0O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgfSk7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoRm9ybVxyXG5cclxuLy9pbmRleC5qc1xyXG5cclxuLy8gY29uc3QgbmV3Q2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjcHJvZmlsZS1hZGQtY2FyZC1tb2RhbFwiLCAoKSA9PiB7fSk7XHJcbi8vIG5ld0NhcmRQb3B1cC5vcGVuXHJcblxyXG5cclxuLy8gbmV3Q2FyZFBvcHVwLmNsb3NlKCkiLCIvLyBJbXBvcnQgYWxsIHRoZSBjbGFzc2VzXHJcbmltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgeyBpbml0aWFsQ2FyZHMsIHZhbGlkYXRpb25TZXR0aW5ncyB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHNcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZFwiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb25cIjtcclxuaW1wb3J0IFBvcHVwIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm1cIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mb1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaVwiO1xyXG5cclxuXHJcbi8vIFByb2ZpbGUgRWRpdFxyXG5jb25zdCBwcm9maWxlRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtbW9kYWxcIik7XHJcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xyXG5jb25zdCBwcm9maWxlQXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWF2YXRhci1idXR0b25cIik7XHJcbmNvbnN0IHByb2ZpbGVDbG9zZUJ1dHRvbiA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XHJcbmNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybV9lZGl0XCIpO1xyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiKTtcclxuY29uc3QgcHJvZmlsZVRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtdGl0bGUtaW5wdXRcIik7XHJcbmNvbnN0IHByb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XHJcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XHJcblxyXG5cclxuLy8gQWRkIENhcmRcclxuY29uc3QgcHJvZmlsZUFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1hZGQtY2FyZC1tb2RhbFwiKTtcclxuY29uc3QgcHJvZmlsZUFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtYWRkLWJ1dHRvblwiKTtcclxuY29uc3QgcHJvZmlsZUFkZENhcmRDbG9zZUJ1dHRvbiA9IHByb2ZpbGVBZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XHJcbmNvbnN0IGFkZENhcmRGb3JtID0gcHJvZmlsZUFkZENhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtX2FkZFwiKTtcclxuY29uc3QgcHJvZmlsZUFkZENhcmRUaXRsZUlucHV0ID0gcHJvZmlsZUFkZENhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbnB1dF90eXBlX3RpdGxlXCIpO1xyXG5jb25zdCBwcm9maWxlQWRkQ2FyZFVybElucHV0ID0gcHJvZmlsZUFkZENhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbnB1dF90eXBlX3VybFwiKTtcclxuXHJcbi8vIFByZXZpZXcgSW1hZ2UgTW9kYWxcclxuY29uc3QgaW1hZ2VQcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2ltYWdlLXByZXZpZXctbW9kYWxcIik7XHJcbmNvbnN0IG1vZGFsSW1hZ2VFbGVtZW50ID0gaW1hZ2VQcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2UtcHJldmlld1wiKTtcclxuY29uc3QgbW9kYWxDYXB0aW9uID0gaW1hZ2VQcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2UtY2FwdGlvblwiKTtcclxuY29uc3QgaW1hZ2VQcmV2aWV3Q2xvc2VCdXR0b24gPSBpbWFnZVByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcclxuXHJcbi8vIENvbmZpcm0gRGVsZXRlIE1vZGFsXHJcbmNvbnN0IHRyYXNoSWNvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY29uZmlybS1kZWxldGUtbW9kYWxcIik7XHJcbmNvbnN0IHRyYXNoU3VibWl0QnV0dG9uID0gdHJhc2hJY29uLnF1ZXJ5U2VsZWN0b3IoXCIjY29uZmlybS1kZWxldGUtc3VibWl0XCIpXHJcblxyXG4vLyBBdmF0YXIgRWRpdCBNb2RhbFxyXG5jb25zdCBhdmF0YXJFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1lZGl0LW1vZGFsXCIpO1xyXG5cclxuY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7XHJcblxyXG5cclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcImYzNGZjOTQwLTY0NDQtNGM4NC05NjQzLTkxNWU4NzY4ODlmYlwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfVxyXG59KTsgXHJcblxyXG5sZXQgY2FyZFNlY3Rpb247XHJcblxyXG5hcGlcclxuICAuZ2V0SW5pdGlhbENhcmRzKClcclxuICAudGhlbigocmVzKSA9PiB7XHJcbiAgICBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKHtcclxuICAgICAgaXRlbXM6IHJlcyxcclxuICAgICAgcmVuZGVyZXI6IChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGNhcmRFbCA9IHJlbmRlckNhcmQoY2FyZERhdGEpO1xyXG4gICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsKTtcclxuICAgICAgfSxcclxuICAgIH0sICBcclxuICBcIi5jYXJkc19fbGlzdFwiXHJcbiAgKTtcclxuICBcclxuICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoZXJyKTsgXHJcbiAgfSk7XHJcbiAgXHJcbmNvbnN0IHByb2ZpbGVVc2VySW5mbyA9IG5ldyBVc2VySW5mbyhcIi5wcm9maWxlX190aXRsZVwiLCBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLCBcIi5wcm9maWxlX19pbWFnZVwiKTsgIFxyXG5cclxuXHJcblxyXG5cclxuY29uc3QgZWRpdEZvcm1FbGVtZW50ID0gcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtX2VkaXRcIik7ICBcclxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uU2V0dGluZ3MsIGVkaXRGb3JtRWxlbWVudCk7ICBcclxuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpOyAgXHJcblxyXG5jb25zdCBhdmF0YXJGb3JtRWxlbWVudCA9IGF2YXRhckVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtX2F2YXRhclwiKTsgIFxyXG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBhdmF0YXJGb3JtRWxlbWVudCk7ICBcclxuYXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5jb25zdCBhZGRGb3JtRWxlbWVudCA9IHByb2ZpbGVBZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybV9hZGRcIik7ICBcclxuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgYWRkRm9ybUVsZW1lbnQpOyAgXHJcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpOyAgXHJcblxyXG5cclxuY29uc3QgcG9wdXBXaXRoSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjaW1hZ2UtcHJldmlldy1tb2RhbFwiKTsgIFxyXG5wb3B1cFdpdGhJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlUHJldmlld1BpY3R1cmUobmFtZSwgbGluaykge1xyXG4gIHBvcHVwV2l0aEltYWdlLm9wZW4obmFtZSwgbGluayk7XHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiByZW5kZXJDYXJkKGNhcmREYXRhKSB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgY2FyZERhdGEsIFxyXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxyXG4gICAgaGFuZGxlUHJldmlld1BpY3R1cmUsXHJcbiAgICBoYW5kbGVEZWxldGVDbGljayxcclxuICAgIGhhbmRsZUxpa2VDbGljayxcclxuICApO1xyXG4gIHJldHVybiBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xyXG59XHJcblxyXG5jb25zdCBwcm9maWxlRWRpdEZvcm1Qb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLCBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdCk7ICBcclxucHJvZmlsZUVkaXRGb3JtUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0KGlucHV0VmFsdWVzKSB7XHJcbiAgcHJvZmlsZUVkaXRGb3JtUG9wdXAuc2V0TG9hZGluZyh0cnVlKTtcclxuICBhcGlcclxuICAuZWRpdFByb2ZpbGVJbmZvKGlucHV0VmFsdWVzKVxyXG4gIC50aGVuKChyZXMpID0+IHtcclxuICAgIHByb2ZpbGVVc2VySW5mby5zZXRVc2VySW5mbyhpbnB1dFZhbHVlcy50aXRsZSwgaW5wdXRWYWx1ZXMuZGVzY3JpcHRpb24pO1xyXG4gICAgcHJvZmlsZUVkaXRGb3JtUG9wdXAuY2xvc2UoKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgfSlcclxuICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICBwcm9maWxlRWRpdEZvcm1Qb3B1cC5zZXRMb2FkaW5nKGZhbHNlKTtcclxuICB9KTtcclxuXHJcbn07XHJcblxyXG5jb25zdCBwcm9maWxlQWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjcHJvZmlsZS1hZGQtY2FyZC1tb2RhbFwiLCBoYW5kbGVQcm9maWxlQWRkQ2FyZFN1Ym1pdCk7ICBcclxucHJvZmlsZUFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUFkZENhcmRTdWJtaXQoaW5wdXRWYWx1ZXMpIHtcclxuICBwcm9maWxlQWRkQ2FyZFBvcHVwLnNldExvYWRpbmcodHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAuYWRkQ2FyZChpbnB1dFZhbHVlcylcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgY29uc3QgY2FyZERhdGEgPSByZW5kZXJDYXJkKHtuYW1lOiBpbnB1dFZhbHVlcy50aXRsZSwgbGluazogaW5wdXRWYWx1ZXMudXJsIH0pO1xyXG4gICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmREYXRhKTtcclxuICAgICAgcHJvZmlsZUFkZENhcmRQb3B1cC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHByb2ZpbGVBZGRDYXJkUG9wdXAuc2V0TG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbmNvbnN0IGF2YXRhckVkaXRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI2F2YXRhci1lZGl0LW1vZGFsXCIsIGhhbmRsZUVkaXRBdmF0YXJTdWJtaXQpO1xyXG5hdmF0YXJFZGl0UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUVkaXRBdmF0YXJTdWJtaXQoaW5wdXRWYWx1ZXMpIHtcclxuICBhdmF0YXJFZGl0UG9wdXAuc2V0TG9hZGluZyh0cnVlKTtcclxuICBhcGlcclxuICAgIC5lZGl0UHJvZmlsZVBpY3R1cmUoaW5wdXRWYWx1ZXMubGluaylcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgcHJvZmlsZVVzZXJJbmZvLnNldFVzZXJBdmF0YXIocmVzLmF2YXRhcilcclxuICAgICAgYXZhdGFyRWRpdFBvcHVwLmNsb3NlKClcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBhdmF0YXJFZGl0UG9wdXAuc2V0TG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KVxyXG59XHJcblxyXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGVkaXRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGNvbnN0IHVzZXJJbmZvID0gcHJvZmlsZVVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgcHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSB1c2VySW5mby5uYW1lO1xyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gdXNlckluZm8uam9iO1xyXG4gIHByb2ZpbGVFZGl0Rm9ybVBvcHVwLm9wZW4oKTtcclxuICBcclxufSk7XHJcblxyXG5wcm9maWxlQWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHByb2ZpbGVBZGRDYXJkUG9wdXAub3BlbigpO1xyXG4gIGFkZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn0pO1xyXG5cclxucHJvZmlsZUF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGF2YXRhckVkaXRQb3B1cC5vcGVuKCk7XHJcbn0pO1xyXG5cclxuY29uc3QgY29uZmlybURlbGV0ZSA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24oXCIjY29uZmlybS1kZWxldGUtbW9kYWxcIik7XHJcbmNvbmZpcm1EZWxldGUuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDbGljayhjYXJkKSB7XHJcbiAgY29uZmlybURlbGV0ZS5vcGVuKCk7XHJcbiAgY29uZmlybURlbGV0ZS5zZXRTdWJtaXRBY3Rpb24oKCkgPT4geyAgXHJcbiAgICBhcGlcclxuICAgIC5kZWxldGVDYXJkKGNhcmQuX2lkKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICBjYXJkLmhhbmRsZURlbGV0ZUNsaWNrKCk7XHJcbiAgICAgIGNvbmZpcm1EZWxldGUuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICB9KVxyXG4gIH0pO1xyXG5cclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlTGlrZUNsaWNrKGNhcmQpIHtcclxuICBpZiAoY2FyZC5pc0xpa2VkKSB7XHJcbiAgICBhcGlcclxuICAgIC5saWtlQ2FyZChjYXJkLl9pZClcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgY2FyZC5oYW5kbGVMaWtlQ2xpY2soKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICB9KTtcclxuICB9IGVsc2Uge1xyXG4gICAgYXBpXHJcbiAgICAudW5saWtlQ2FyZChjYXJkLl9pZClcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgY2FyZC5oYW5kbGVMaWtlQ2xpY2soKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICB9KTtcclxuICB9XHJcbn0gICAgICAgICIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG4gIFxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCBcclxuICAgIHsgaGVhZGVyczogdGhpcy5faGVhZGVycywgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gIH07XHJcblxyXG4gIGxvYWRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcclxuICB9O1xyXG5cclxuICBlZGl0UHJvZmlsZUluZm8oY2FyZERhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIFxyXG4gICAge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IGNhcmREYXRhLnRpdGxlLFxyXG4gICAgICAgIGFib3V0OiBjYXJkRGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpICBcclxuICB9O1xyXG5cclxuICBhZGRDYXJkKGlucHV0VmFsdWVzKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCBcclxuICAgIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IGlucHV0VmFsdWVzLnRpdGxlLFxyXG4gICAgICAgIGxpbms6IGlucHV0VmFsdWVzLnVybCxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgfTtcclxuXHJcbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCBcclxuICAgIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSlcclxuICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgfTtcclxuXHJcbiAgbGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwgXHJcbiAgICB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pXHJcbiAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gIH07XHJcblxyXG4gIHVubGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwgXHJcbiAgICB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pXHJcbiAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gIH07XHJcblxyXG4gIGVkaXRQcm9maWxlUGljdHVyZShsaW5rKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwgXHJcbiAgICB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyOiBsaW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSkgXHJcbiAgfVxyXG5cclxuICBsb2FkUGFnZUNvbnRlbnQoKSB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMubG9hZFVzZXJJbmZvKCksIHRoaXMuZ2V0SW5pdGlhbENhcmRzKCldKTtcclxuICB9XHJcblxyXG5cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IobmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fam9iRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xyXG4gIH1cclxuICBcclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIGNvbnN0IHVzZXJJbmZvID0ge1xyXG4gICAgICBuYW1lOiB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCxcclxuICAgICAgam9iOiB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgfTtcclxuICAgIHJldHVybiB1c2VySW5mbztcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKG5hbWUsIGpvYikge1xyXG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCA9IGpvYjtcclxuICB9XHJcblxyXG4gIHNldFVzZXJBdmF0YXIoYXZhdGFyKSB7XHJcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50LnNyYyA9IGF2YXRhcjtcclxuICB9XHJcbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KVxyXG4gICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2UtcHJldmlld1wiKTtcclxuICAgIHRoaXMuX2NhcHRpb24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2UtY2FwdGlvblwiKTtcclxuICB9XHJcblxyXG5cclxuICBvcGVuKG5hbWUsIGxpbmspIHtcclxuICAgIHRoaXMuX2ltYWdlLnNyYyA9IGxpbms7XHJcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSBuYW1lO1xyXG4gICAgdGhpcy5fY2FwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfSBcclxufVxyXG5cclxuICIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KVxyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xyXG4gIH1cclxuXHJcbiAgc2V0U3VibWl0QWN0aW9uKGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gIH0gIFxyXG5cclxuICBzZXRMb2FkaW5nKCkge1xyXG4gICAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIkRlbGV0aW5nLi4uXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdXR0b25UZXh0O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoKTtcclxuICAgIH0pO1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn0iXSwibmFtZXMiOlsidmFsaWRhdGlvblNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJjb25zdHJ1Y3RvciIsImNhcmREYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlUHJldmlld1BpY3R1cmUiLCJoYW5kbGVEZWxldGVDbGljayIsImhhbmRsZUxpa2VDbGljayIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfaWQiLCJfaXNMaWtlZCIsImlzTGlrZWQiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZVByZXZpZXdQaWN0dXJlIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2hhbmRsZUxpa2VDbGljayIsIl9nZXRUZW1wbGF0ZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsImNsb25lTm9kZSIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9jYXJkSW1hZ2VFbCIsImFkZEV2ZW50TGlzdGVuZXIiLCJfZGVsZXRlQnV0dG9uIiwiX2VsZW1lbnQiLCJfbGlrZUJ1dHRvbiIsIl9oYW5kbGVMaWtlQnV0dG9uIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiX3VwZGF0ZUxpa2VTdGF0dXMiLCJhZGQiLCJyZW1vdmUiLCJnZW5lcmF0ZUNhcmQiLCJfY2FyZFRpdGxlRWwiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsIm9wdGlvbnMiLCJmb3JtRWwiLCJfaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiX2Zvcm1FbCIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWwiLCJlcnJvck1lc3NhZ2VFbCIsImlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfaW5wdXRFbHMiLCJldmVyeSIsImRpc2FibGVCdXR0b24iLCJfc3VibWl0QnV0dG9uIiwiZGlzYWJsZWQiLCJfZW5hYmxlQnV0dG9uIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJlIiwiZW5hYmxlVmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwicmVzZXRWYWxpZGF0aW9uIiwiaW5wdXRFbGVtZW50IiwiU2VjdGlvbiIsIl9yZWYiLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50Iiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2dCIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfaW5wdXRMaXN0IiwicmVzZXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJzZXRMb2FkaW5nIiwiaXNMb2FkaW5nIiwiX3N1Ym1pdEJ1dHRvblRleHQiLCJwcm9maWxlRWRpdE1vZGFsIiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlQXZhdGFyQnV0dG9uIiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJwcm9maWxlVGl0bGVJbnB1dCIsInByb2ZpbGVBZGRDYXJkTW9kYWwiLCJwcm9maWxlQWRkQ2FyZEJ1dHRvbiIsImltYWdlUHJldmlld01vZGFsIiwiYXZhdGFyRWRpdE1vZGFsIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJ0aGVuIiwibG9hZFVzZXJJbmZvIiwibWV0aG9kIiwiZWRpdFByb2ZpbGVJbmZvIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ0aXRsZSIsImFib3V0IiwiZGVzY3JpcHRpb24iLCJhZGRDYXJkIiwidXJsIiwiZGVsZXRlQ2FyZCIsImNhcmRJZCIsImxpa2VDYXJkIiwidW5saWtlQ2FyZCIsImVkaXRQcm9maWxlUGljdHVyZSIsImF2YXRhciIsImxvYWRQYWdlQ29udGVudCIsImFsbCIsImF1dGhvcml6YXRpb24iLCJjYXJkU2VjdGlvbiIsImNhcmRFbCIsInJlbmRlckNhcmQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsInByb2ZpbGVVc2VySW5mbyIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfbmFtZUVsZW1lbnQiLCJfam9iRWxlbWVudCIsIl9hdmF0YXJFbGVtZW50IiwiZ2V0VXNlckluZm8iLCJqb2IiLCJzZXRVc2VySW5mbyIsInNldFVzZXJBdmF0YXIiLCJlZGl0Rm9ybVZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiLCJhZGRGb3JtVmFsaWRhdG9yIiwicG9wdXBXaXRoSW1hZ2UiLCJfaW1hZ2UiLCJfY2FwdGlvbiIsIkNhcmQiLCJwcm9maWxlRWRpdEZvcm1Qb3B1cCIsIlBvcHVwV2l0aEZvcm0iLCJmaW5hbGx5IiwicHJvZmlsZUFkZENhcmRQb3B1cCIsImF2YXRhckVkaXRQb3B1cCIsInVzZXJJbmZvIiwiY29uZmlybURlbGV0ZSIsInNldFN1Ym1pdEFjdGlvbiIsImNhcmQiXSwic291cmNlUm9vdCI6IiJ9