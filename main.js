!function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"};var t=class{constructor(e,t,s,i,r){this._name=e.name,this._link=e.link,this._id=e._id,this._isLiked=e.isLiked,this._cardSelector=t,this._handlePreviewPicture=s,this._handleDeleteClick=i,this._handleLikeClick=r}_getTemplate(){return document.querySelector(this._cardSelector).content.firstElementChild.cloneNode(!0)}_setEventListeners(){this._cardImageEl.addEventListener("click",(()=>{this._handlePreviewPicture(this._name,this._link)})),this._deleteButton=this._element.querySelector(".card__delete-button"),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteClick(this)})),this._likeButton.addEventListener("click",(()=>{this._handleLikeClick()}))}_handleLikeButton(){this._element.querySelector(".card__like-button").classList.toggle("card__like-button_active")}_updateLikeStatus(){this._isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}handleDeleteClick(){this._element.remove(),this._element=null}generateCard(){return this._element=this._getTemplate(),this._cardImageEl=this._element.querySelector(".card__image"),this._cardTitleEl=this._element.querySelector(".card__title"),this._cardImageEl.src=this._link,this._cardImageEl.alt=this._name,this._cardTitleEl.textContent=this._name,this._deleteButton=this._element.querySelector(".card__delete-button"),this._likeButton=this._element.querySelector(".card__like-button"),this._setEventListeners(),this._element}},s=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formEl=t}_showInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return!this._inputEls.every((e=>e.validity.valid))}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_toggleButtonState(){this._hasInvalidInput(this._inputEls)?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_setEventListeners(){this._inputEls=[...this._formEl.querySelectorAll(this._inputSelector)],this._submitButton=this._formEl.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formEl.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputEls.forEach((e=>{this._hideInputError(e)}))}};class i{constructor(e,t){let{items:s,renderer:i}=e;this._items=s,this._renderer=i,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}class r{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("click",(e=>{(e.target===this._popupElement||e.target.classList.contains("modal__close"))&&this.close()}))}}var n=class extends r{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputList=this._popupForm.querySelectorAll(".modal__input"),this._submitButton=this._popupForm.querySelector(".modal__button")}close(){this._popupForm.reset(),super.close()}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setLoading(e){this._submitButton.textContent=e?"Saving...":this._submitButtonText}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}};const o=document.querySelector("#profile-edit-modal"),l=document.querySelector("#profile-edit-button"),a=document.querySelector("#profile-avatar-button"),c=(o.querySelector(".modal__close"),o.querySelector(".modal__form_edit"),document.querySelector("#profile-description-input")),d=document.querySelector("#profile-title-input"),_=(document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector("#profile-add-card-modal")),u=document.querySelector("#profile-add-button"),h=(_.querySelector(".modal__close"),_.querySelector(".modal__form_add"),_.querySelector(".modal__input_type_title"),_.querySelector(".modal__input_type_url"),document.querySelector("#image-preview-modal")),m=(h.querySelector(".modal__image-preview"),h.querySelector(".modal__image-caption"),h.querySelector(".modal__close"),document.querySelector("#confirm-delete-modal").querySelector("#confirm-delete-submit"),document.querySelector("#avatar-edit-modal")),p=(document.querySelector("#card-template").content.firstElementChild,new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}loadUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then(this._checkResponse)}editProfileInfo(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.title,about:e.description})}).then(this._checkResponse)}addCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.title,link:e.url})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}unlikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}editProfilePicture(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}loadPageContent(){return Promise.all([this.loadUserInfo(),this.getInitialCards()])}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"f34fc940-6444-4c84-9643-915e876889fb","Content-Type":"application/json"}}));let E;p.getInitialCards().then((e=>{E=new i({items:e,renderer:e=>{const t=L(e);E.addItem(t)}},".cards__list"),E.renderItems()})).catch((e=>{console.error(e)}));const v=new class{constructor(e,t,s){this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t),this._avatarElement=document.querySelector(s)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo(e,t){this._nameElement.textContent=e,this._jobElement.textContent=t}setUserAvatar(e){this._avatarElement.src=e}}(".profile__title",".profile__description",".profile__image"),S=new s(e,o.querySelector(".modal__form_edit"));S.enableValidation(),new s(e,m.querySelector(".modal__form_avatar")).enableValidation();const b=new s(e,_.querySelector(".modal__form_add"));b.enableValidation();const f=new class extends r{constructor(e){super({popupSelector:e}),this._image=this._popupElement.querySelector(".modal__image-preview"),this._caption=this._popupElement.querySelector(".modal__image-caption")}open(e,t){this._image.src=t,this._image.alt=e,this._caption.textContent=e,super.open()}}("#image-preview-modal");function y(e,t){f.open(e,t)}function L(e){return new t(e,"#card-template",y,I,q).generateCard()}f.setEventListeners();const k=new n("#profile-edit-modal",(function(e){k.setLoading(!0),p.editProfileInfo(e).then((t=>{v.setUserInfo(e.title,e.description),k.close()})).catch((e=>{console.error(e)})).finally((()=>{k.setLoading(!1)}))}));k.setEventListeners();const C=new n("#profile-add-card-modal",(function(e){C.setLoading(!0),p.addCard(e).then((t=>{const s=L({name:e.title,link:e.url});E.addItem(s),C.close()})).catch((e=>{console.error(e)})).finally((()=>{C.setLoading(!1)}))}));C.setEventListeners();const g=new n("#avatar-edit-modal",(function(e){g.setLoading(!0),p.editProfilePicture(e.link).then((e=>{v.setUserAvatar(e.avatar),g.close()})).catch((e=>{console.error(e)})).finally((()=>{g.setLoading(!1)}))}));function q(e){e.isLiked?p.likeCard(e._id).then((t=>{e.handleLikeClick()})).catch((e=>{console.error(e)})):p.unlikeCard(e._id).then((t=>{e.handleLikeClick()})).catch((e=>{console.error(e)}))}g.setEventListeners(),l.addEventListener("click",(()=>{S.resetValidation();const e=v.getUserInfo();d.value=e.name,c.value=e.job,k.open()})),u.addEventListener("click",(()=>{C.open(),b.resetValidation()})),a.addEventListener("click",(()=>{g.open()}));const B=new class extends r{constructor(e){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._submitButton=this._popupForm.querySelector(".modal__button")}setSubmitAction(e){this._handleFormSubmit=e}setLoading(){isLoading?this._submitButton.textContent="Deleting...":this._submitButton.textContent=this._submitButtonText}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{this._handleFormSubmit()})),super.setEventListeners()}}("#confirm-delete-modal");function I(e){B.open(),B.setSubmitAction((()=>{p.deleteCard(e._id).then((()=>{e.handleDeleteClick(),B.close()})).catch((e=>{console.error(e)}))}))}B.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQU8sTUFpQ01BLEVBQXFCLENBQzlCQyxhQUFjLGVBQ2RDLGNBQWUsZ0JBQ2ZDLHFCQUFzQixpQkFDdEJDLG9CQUFxQix5QkFDckJDLGdCQUFpQiwwQkFDakJDLFdBQVksd0JDdUNoQixNQTlFQSxNQUNFQyxXQUFBQSxDQUFZQyxFQUFVQyxFQUFjQyxFQUFzQkMsRUFBbUJDLEdBRTNFQyxLQUFLQyxNQUFRTixFQUFTTyxLQUN0QkYsS0FBS0csTUFBUVIsRUFBU1MsS0FDdEJKLEtBQUtLLElBQU1WLEVBQVNVLElBQ3BCTCxLQUFLTSxTQUFXWCxFQUFTWSxRQUN6QlAsS0FBS1EsY0FBZ0JaLEVBQ3JCSSxLQUFLUyxzQkFBd0JaLEVBQzdCRyxLQUFLVSxtQkFBcUJaLEVBQzFCRSxLQUFLVyxpQkFBbUJaLENBQzFCLENBRUFhLFlBQUFBLEdBS0UsT0FKb0JDLFNBQ2pCQyxjQUFjZCxLQUFLUSxlQUNuQk8sUUFBUUMsa0JBQ1JDLFdBQVUsRUFFZixDQUVBQyxrQkFBQUEsR0FFRWxCLEtBQUttQixhQUFhQyxpQkFBaUIsU0FBUyxLQUMxQ3BCLEtBQUtTLHNCQUFzQlQsS0FBS0MsTUFBT0QsS0FBS0csTUFBTSxJQUdwREgsS0FBS3FCLGNBQWdCckIsS0FBS3NCLFNBQVNSLGNBQWMsd0JBQ2pEZCxLQUFLcUIsY0FBY0QsaUJBQWlCLFNBQVMsS0FDM0NwQixLQUFLVSxtQkFBbUJWLEtBQUssSUFHL0JBLEtBQUt1QixZQUFZSCxpQkFBaUIsU0FBUyxLQUN6Q3BCLEtBQUtXLGtCQUFrQixHQUczQixDQUVBYSxpQkFBQUEsR0FDRXhCLEtBQUtzQixTQUNGUixjQUFjLHNCQUNkVyxVQUFVQyxPQUFPLDJCQUN0QixDQUVBQyxpQkFBQUEsR0FDTTNCLEtBQUtNLFNBQ1BOLEtBQUt1QixZQUFZRSxVQUFVRyxJQUFJLDRCQUUvQjVCLEtBQUt1QixZQUFZRSxVQUFVSSxPQUFPLDJCQUV0QyxDQUVBL0IsaUJBQUFBLEdBQ0VFLEtBQUtzQixTQUFTTyxTQUNkN0IsS0FBS3NCLFNBQVcsSUFDbEIsQ0FHQVEsWUFBQUEsR0FlRSxPQWRBOUIsS0FBS3NCLFNBQVd0QixLQUFLWSxlQUVyQlosS0FBS21CLGFBQWVuQixLQUFLc0IsU0FBU1IsY0FBYyxnQkFDaERkLEtBQUsrQixhQUFlL0IsS0FBS3NCLFNBQVNSLGNBQWMsZ0JBRWhEZCxLQUFLbUIsYUFBYWEsSUFBTWhDLEtBQUtHLE1BQzdCSCxLQUFLbUIsYUFBYWMsSUFBTWpDLEtBQUtDLE1BQzdCRCxLQUFLK0IsYUFBYUcsWUFBY2xDLEtBQUtDLE1BRXJDRCxLQUFLcUIsY0FBZ0JyQixLQUFLc0IsU0FBU1IsY0FBYyx3QkFDakRkLEtBQUt1QixZQUFjdkIsS0FBS3NCLFNBQVNSLGNBQWMsc0JBRS9DZCxLQUFLa0IscUJBRUVsQixLQUFLc0IsUUFDZCxHQ2FGLEVBdkZBLE1BQ0U1QixXQUFBQSxDQUFZeUMsRUFBU0MsR0FDbkJwQyxLQUFLcUMsZUFBaUJGLEVBQVE5QyxjQUM5QlcsS0FBS3NDLHNCQUF3QkgsRUFBUTdDLHFCQUNyQ1UsS0FBS3VDLHFCQUF1QkosRUFBUTVDLG9CQUNwQ1MsS0FBS3dDLGlCQUFtQkwsRUFBUTNDLGdCQUNoQ1EsS0FBS3lDLFlBQWNOLEVBQVExQyxXQUMzQk8sS0FBSzBDLFFBQVVOLENBQ2pCLENBRUFPLGVBQUFBLENBQWdCQyxHQUNkLE1BQU1DLEVBQWlCN0MsS0FBSzBDLFFBQVE1QixjQUFlLElBQUc4QixFQUFRRSxZQUM5REYsRUFBUW5CLFVBQVVHLElBQUk1QixLQUFLd0Msa0JBQzNCSyxFQUFlWCxZQUFjVSxFQUFRRyxrQkFDckNGLEVBQWVwQixVQUFVRyxJQUFJNUIsS0FBS3lDLFlBQ3BDLENBRUFPLGVBQUFBLENBQWdCSixHQUNkLE1BQU1DLEVBQWlCN0MsS0FBSzBDLFFBQVE1QixjQUFlLElBQUc4QixFQUFRRSxZQUM5REYsRUFBUW5CLFVBQVVJLE9BQU83QixLQUFLd0Msa0JBQzlCSyxFQUFlWCxZQUFjLEdBQzdCVyxFQUFlcEIsVUFBVUksT0FBTzdCLEtBQUt5QyxZQUN2QyxDQUVBUSxtQkFBQUEsQ0FBb0JMLEdBQ2JBLEVBQVFNLFNBQVNDLE1BR3JCbkQsS0FBS2dELGdCQUFnQkosR0FGcEI1QyxLQUFLMkMsZ0JBQWdCQyxFQUl6QixDQUVBUSxnQkFBQUEsR0FDRSxPQUFRcEQsS0FBS3FELFVBQVVDLE9BQU9WLEdBQVlBLEVBQVFNLFNBQVNDLE9BQzdELENBRUFJLGFBQUFBLEdBQ0V2RCxLQUFLd0QsY0FBYy9CLFVBQVVHLElBQUk1QixLQUFLdUMsc0JBQ3RDdkMsS0FBS3dELGNBQWNDLFVBQVcsQ0FDaEMsQ0FFQUMsYUFBQUEsR0FDRTFELEtBQUt3RCxjQUFjL0IsVUFBVUksT0FBTzdCLEtBQUt1QyxzQkFDekN2QyxLQUFLd0QsY0FBY0MsVUFBVyxDQUNoQyxDQUVBRSxrQkFBQUEsR0FDTTNELEtBQUtvRCxpQkFBaUJwRCxLQUFLcUQsWUFDN0JyRCxLQUFLd0QsY0FBYy9CLFVBQVVHLElBQUk1QixLQUFLdUMsc0JBQ3RDdkMsS0FBS3dELGNBQWNDLFVBQVcsSUFHOUJ6RCxLQUFLd0QsY0FBYy9CLFVBQVVJLE9BQU83QixLQUFLdUMsc0JBQ3pDdkMsS0FBS3dELGNBQWNDLFVBQVcsRUFFbEMsQ0FFQXZDLGtCQUFBQSxHQUNFbEIsS0FBS3FELFVBQVksSUFBSXJELEtBQUswQyxRQUFRa0IsaUJBQWlCNUQsS0FBS3FDLGlCQUN4RHJDLEtBQUt3RCxjQUFnQnhELEtBQUswQyxRQUFRNUIsY0FBY2QsS0FBS3NDLHVCQUVyRHRDLEtBQUtxRCxVQUFVUSxTQUFTakIsSUFDdEJBLEVBQVF4QixpQkFBaUIsU0FBVTBDLElBQ2pDOUQsS0FBS2lELG9CQUFvQkwsR0FDekI1QyxLQUFLMkQsb0JBQW9CLEdBQ3pCLEdBRU4sQ0FFQUksZ0JBQUFBLEdBQ0UvRCxLQUFLMEMsUUFBUXRCLGlCQUFpQixVQUFXMEMsSUFDdkNBLEVBQUVFLGdCQUFnQixJQUVwQmhFLEtBQUtrQixvQkFDUCxDQUdBK0MsZUFBQUEsR0FDQWpFLEtBQUsyRCxxQkFFTDNELEtBQUtxRCxVQUFVUSxTQUFTSyxJQUN0QmxFLEtBQUtnRCxnQkFBZ0JrQixFQUFhLEdBRXBDLEdDbkZhLE1BQU1DLEVBQ25CekUsV0FBQUEsQ0FBVzBFLEVBQXNCQyxHQUFtQixJQUF4QyxNQUFFQyxFQUFLLFNBQUVDLEdBQVVILEVBQzdCcEUsS0FBS3dFLE9BQVNGLEVBQ2R0RSxLQUFLeUUsVUFBWUYsRUFDakJ2RSxLQUFLMEUsV0FBYTdELFNBQVNDLGNBQWN1RCxFQUMzQyxDQUVBTSxXQUFBQSxHQUNFM0UsS0FBS3dFLE9BQU9YLFNBQVNsRSxJQUNuQkssS0FBS3lFLFVBQVU5RSxFQUFTLEdBRTVCLENBRUFpRixPQUFBQSxDQUFRQyxHQUNON0UsS0FBSzBFLFdBQVdJLFFBQVFELEVBQzFCLEVDYmEsTUFBTUUsRUFDbkJyRixXQUFBQSxDQUFXMEUsR0FBb0IsSUFBbkIsY0FBRVksR0FBZVosRUFDM0JwRSxLQUFLaUYsY0FBZ0JwRSxTQUFTQyxjQUFja0UsRUFDOUMsQ0FFQUUsSUFBQUEsR0FDRWxGLEtBQUtpRixjQUFjeEQsVUFBVUcsSUFBSSxnQkFDakNmLFNBQVNPLGlCQUFpQixVQUFXcEIsS0FBS21GLGdCQUM1QyxDQUVBQyxLQUFBQSxHQUNFcEYsS0FBS2lGLGNBQWN4RCxVQUFVSSxPQUFPLGdCQUNwQ2hCLFNBQVN3RSxvQkFBb0IsVUFBV3JGLEtBQUttRixnQkFDL0MsQ0FFQUEsZ0JBQW1CRyxJQUNELFdBQVpBLEVBQUlDLEtBQ052RixLQUFLb0YsT0FDUCxFQUdGSSxpQkFBQUEsR0FDRXhGLEtBQUtpRixjQUFjN0QsaUJBQWlCLFNBQVVrRSxLQUUxQ0EsRUFBSUcsU0FBV3pGLEtBQUtpRixlQUNwQkssRUFBSUcsT0FBT2hFLFVBQVVpRSxTQUFTLGtCQUU5QjFGLEtBQUtvRixPQUNQLEdBRUosRUNXRixNQXpDQSxjQUE0QkwsRUFDMUJyRixXQUFBQSxDQUFZc0YsRUFBZVcsR0FDekJDLE1BQU0sQ0FBRVosa0JBQ1JoRixLQUFLNkYsV0FBYTdGLEtBQUtpRixjQUFjbkUsY0FBYyxnQkFDbkRkLEtBQUs4RixrQkFBb0JILEVBQ3pCM0YsS0FBSytGLFdBQWEvRixLQUFLNkYsV0FBV2pDLGlCQUFpQixpQkFDbkQ1RCxLQUFLd0QsY0FBZ0J4RCxLQUFLNkYsV0FBVy9FLGNBQWMsaUJBRXJELENBRUFzRSxLQUFBQSxHQUNFcEYsS0FBSzZGLFdBQVdHLFFBQ2hCSixNQUFNUixPQUNSLENBR0FhLGVBQUFBLEdBQ0UsTUFBTUMsRUFBYyxDQUFDLEVBSXJCLE9BSEFsRyxLQUFLK0YsV0FBV2xDLFNBQVNzQyxJQUN2QkQsRUFBWUMsRUFBTWpHLE1BQVFpRyxFQUFNQyxLQUFLLElBRWhDRixDQUNULENBRUFHLFVBQUFBLENBQVdDLEdBRVB0RyxLQUFLd0QsY0FBY3RCLFlBRGpCb0UsRUFDK0IsWUFFQXRHLEtBQUt1RyxpQkFFMUMsQ0FFQWYsaUJBQUFBLEdBQ0V4RixLQUFLNkYsV0FBV3pFLGlCQUFpQixVQUFXa0UsSUFDMUNBLEVBQUl0QixpQkFDSmhFLEtBQUs4RixrQkFBa0I5RixLQUFLaUcsa0JBQWtCLElBRWhETCxNQUFNSixtQkFDUixHQ3pCRixNQUFNZ0IsRUFBbUIzRixTQUFTQyxjQUFjLHVCQUMxQzJGLEVBQW9CNUYsU0FBU0MsY0FBYyx3QkFDM0M0RixFQUFzQjdGLFNBQVNDLGNBQWMsMEJBRzdDNkYsR0FGcUJILEVBQWlCMUYsY0FBYyxpQkFDbEMwRixFQUFpQjFGLGNBQWMscUJBQ3ZCRCxTQUFTQyxjQUFjLCtCQUNqRDhGLEVBQW9CL0YsU0FBU0MsY0FBYyx3QkFNM0MrRixHQUxlaEcsU0FBU0MsY0FBYyxtQkFDakJELFNBQVNDLGNBQWMseUJBSXRCRCxTQUFTQyxjQUFjLDRCQUM3Q2dHLEVBQXVCakcsU0FBU0MsY0FBYyx1QkFPOUNpRyxHQU40QkYsRUFBb0IvRixjQUFjLGlCQUNoRCtGLEVBQW9CL0YsY0FBYyxvQkFDckIrRixFQUFvQi9GLGNBQWMsNEJBQ3BDK0YsRUFBb0IvRixjQUFjLDBCQUd2Q0QsU0FBU0MsY0FBYyx5QkFVM0NrRyxHQVRvQkQsRUFBa0JqRyxjQUFjLHlCQUNyQ2lHLEVBQWtCakcsY0FBYyx5QkFDckJpRyxFQUFrQmpHLGNBQWMsaUJBRzlDRCxTQUFTQyxjQUFjLHlCQUNMQSxjQUFjLDBCQUcxQkQsU0FBU0MsY0FBYyx1QkFNekNtRyxHQUplcEcsU0FBU0MsY0FBYyxrQkFBa0JDLFFBQVFDLGtCQUkxRCxJQ25ERyxNQUNidEIsV0FBQUEsQ0FBVzBFLEdBQXVCLElBQXRCLFFBQUU4QyxFQUFPLFFBQUVDLEdBQVMvQyxFQUM5QnBFLEtBQUtvSCxTQUFXRixFQUNoQmxILEtBQUtxSCxTQUFXRixDQUNsQixDQUVBRyxjQUFBQSxDQUFlQyxHQUNiLE9BQUlBLEVBQUlDLEdBQ0NELEVBQUlFLE9BRU5DLFFBQVFDLE9BQVEsVUFBU0osRUFBSUssU0FDdEMsQ0FHQUMsZUFBQUEsR0FDRSxPQUFPQyxNQUFPLEdBQUU5SCxLQUFLb0gsaUJBQ3JCLENBQUVELFFBQVNuSCxLQUFLcUgsV0FBYVUsS0FBSy9ILEtBQUtzSCxlQUN6QyxDQUVBVSxZQUFBQSxHQUNFLE9BQU9GLE1BQU8sR0FBRTlILEtBQUtvSCxvQkFBcUIsQ0FDeENhLE9BQVEsTUFDUmQsUUFBU25ILEtBQUtxSCxXQUFZVSxLQUFLL0gsS0FBS3NILGVBQ3hDLENBRUFZLGVBQUFBLENBQWdCdkksR0FDZCxPQUFPbUksTUFBTyxHQUFFOUgsS0FBS29ILG9CQUNyQixDQUNFYSxPQUFRLFFBQ1JkLFFBQVNuSCxLQUFLcUgsU0FDZGMsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQm5JLEtBQU1QLEVBQVMySSxNQUNmQyxNQUFPNUksRUFBUzZJLGdCQUVqQlQsS0FBSy9ILEtBQUtzSCxlQUNmLENBRUFtQixPQUFBQSxDQUFRdkMsR0FDTixPQUFPNEIsTUFBTyxHQUFFOUgsS0FBS29ILGlCQUNyQixDQUNFYSxPQUFRLE9BQ1JkLFFBQVNuSCxLQUFLcUgsU0FDZGMsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQm5JLEtBQU1nRyxFQUFZb0MsTUFDbEJsSSxLQUFNOEYsRUFBWXdDLFFBRW5CWCxLQUFLL0gsS0FBS3NILGVBQ2YsQ0FFQXFCLFVBQUFBLENBQVdDLEdBQ1QsT0FBT2QsTUFBTyxHQUFFOUgsS0FBS29ILGtCQUFrQndCLElBQ3ZDLENBQ0VYLE9BQVEsU0FDUmQsUUFBU25ILEtBQUtxSCxXQUVmVSxLQUFLL0gsS0FBS3NILGVBQ2IsQ0FFQXVCLFFBQUFBLENBQVNELEdBQ1AsT0FBT2QsTUFBTyxHQUFFOUgsS0FBS29ILGtCQUFrQndCLFVBQ3ZDLENBQ0VYLE9BQVEsTUFDUmQsUUFBU25ILEtBQUtxSCxXQUVmVSxLQUFLL0gsS0FBS3NILGVBQ2IsQ0FFQXdCLFVBQUFBLENBQVdGLEdBQ1QsT0FBT2QsTUFBTyxHQUFFOUgsS0FBS29ILGtCQUFrQndCLFVBQ3ZDLENBQ0VYLE9BQVEsU0FDUmQsUUFBU25ILEtBQUtxSCxXQUVmVSxLQUFLL0gsS0FBS3NILGVBQ2IsQ0FFQXlCLGtCQUFBQSxDQUFtQjNJLEdBQ2pCLE9BQU8wSCxNQUFPLEdBQUU5SCxLQUFLb0gsMkJBQ3JCLENBQ0VhLE9BQVEsUUFDUmQsUUFBU25ILEtBQUtxSCxTQUNkYyxLQUFNQyxLQUFLQyxVQUFVLENBQ25CVyxPQUFRNUksTUFFVDJILEtBQUsvSCxLQUFLc0gsZUFDZixDQUVBMkIsZUFBQUEsR0FDRSxPQUFPdkIsUUFBUXdCLElBQUksQ0FBQ2xKLEtBQUtnSSxlQUFnQmhJLEtBQUs2SCxtQkFDaEQsR0R0Q2tCLENBQ2xCWCxRQUFTLGtEQUNUQyxRQUFTLENBQ1BnQyxjQUFlLHVDQUNmLGVBQWdCLHVCQUlwQixJQUFJQyxFQUVKbkMsRUFDR1ksa0JBQ0FFLE1BQU1SLElBQ0w2QixFQUFjLElBQUlqRixFQUFRLENBQ3hCRyxNQUFPaUQsRUFDUGhELFNBQVc1RSxJQUNULE1BQU0wSixFQUFTQyxFQUFXM0osR0FDMUJ5SixFQUFZeEUsUUFBUXlFLEVBQU8sR0FHakMsZ0JBR0FELEVBQVl6RSxhQUFhLElBRXhCNEUsT0FBT0MsSUFDTkMsUUFBUUMsTUFBTUYsRUFBSSxJQUd0QixNQUFNRyxFQUFrQixJRWhGVCxNQUNiakssV0FBQUEsQ0FBWWtLLEVBQWNDLEVBQWFDLEdBQ3JDOUosS0FBSytKLGFBQWVsSixTQUFTQyxjQUFjOEksR0FDM0M1SixLQUFLZ0ssWUFBY25KLFNBQVNDLGNBQWMrSSxHQUMxQzdKLEtBQUtpSyxlQUFpQnBKLFNBQVNDLGNBQWNnSixFQUMvQyxDQUVBSSxXQUFBQSxHQUtFLE1BSmlCLENBQ2ZoSyxLQUFNRixLQUFLK0osYUFBYTdILFlBQ3hCaUksSUFBS25LLEtBQUtnSyxZQUFZOUgsWUFHMUIsQ0FFQWtJLFdBQUFBLENBQVlsSyxFQUFNaUssR0FDaEJuSyxLQUFLK0osYUFBYTdILFlBQWNoQyxFQUNoQ0YsS0FBS2dLLFlBQVk5SCxZQUFjaUksQ0FDakMsQ0FFQUUsYUFBQUEsQ0FBY3JCLEdBQ1poSixLQUFLaUssZUFBZWpJLElBQU1nSCxDQUM1QixHRjBEbUMsa0JBQW1CLHdCQUF5QixtQkFNM0VzQixFQUFvQixJQUFJQyxFQUFjcEwsRUFEcEJxSCxFQUFpQjFGLGNBQWMsc0JBRXZEd0osRUFBa0J2RyxtQkFHVSxJQUFJd0csRUFBY3BMLEVBRHBCNkgsRUFBZ0JsRyxjQUFjLHdCQUVwQ2lELG1CQUVwQixNQUNNeUcsRUFBbUIsSUFBSUQsRUFBY3BMLEVBRHBCMEgsRUFBb0IvRixjQUFjLHFCQUV6RDBKLEVBQWlCekcsbUJBR2pCLE1BQU0wRyxFQUFpQixJR2hHUixjQUE2QjFGLEVBQzFDckYsV0FBQUEsQ0FBWXNGLEdBQ1ZZLE1BQU0sQ0FBRVosa0JBQ1JoRixLQUFLMEssT0FBUzFLLEtBQUtpRixjQUFjbkUsY0FBYyx5QkFDL0NkLEtBQUsySyxTQUFXM0ssS0FBS2lGLGNBQWNuRSxjQUFjLHdCQUNuRCxDQUdBb0UsSUFBQUEsQ0FBS2hGLEVBQU1FLEdBQ1RKLEtBQUswSyxPQUFPMUksSUFBTTVCLEVBQ2xCSixLQUFLMEssT0FBT3pJLElBQU0vQixFQUNsQkYsS0FBSzJLLFNBQVN6SSxZQUFjaEMsRUFDNUIwRixNQUFNVixNQUNSLEdIbUZ3Qyx3QkFHMUMsU0FBU3JGLEVBQXFCSyxFQUFNRSxHQUNsQ3FLLEVBQWV2RixLQUFLaEYsRUFBTUUsRUFDNUIsQ0FHQSxTQUFTa0osRUFBVzNKLEdBUWxCLE9BUGEsSUFBSWlMLEVBQ2ZqTCxFQUNBLGlCQUNBRSxFQUNBQyxFQUNBQyxHQUVVK0IsY0FDZCxDQWhCQTJJLEVBQWVqRixvQkFrQmYsTUFBTXFGLEVBQXVCLElBQUlDLEVBQWMsdUJBRy9DLFNBQWlDNUUsR0FDL0IyRSxFQUFxQnhFLFlBQVcsR0FDaENZLEVBQ0NpQixnQkFBZ0JoQyxHQUNoQjZCLE1BQU1SLElBQ0xvQyxFQUFnQlMsWUFBWWxFLEVBQVlvQyxNQUFPcEMsRUFBWXNDLGFBQzNEcUMsRUFBcUJ6RixPQUFPLElBRTdCbUUsT0FBT0MsSUFDTkMsUUFBUUMsTUFBTUYsRUFBSSxJQUVuQnVCLFNBQVEsS0FDUEYsRUFBcUJ4RSxZQUFXLEVBQU0sR0FHMUMsSUFqQkF3RSxFQUFxQnJGLG9CQW1CckIsTUFBTXdGLEVBQXNCLElBQUlGLEVBQWMsMkJBRzlDLFNBQW9DNUUsR0FDbEM4RSxFQUFvQjNFLFlBQVcsR0FDL0JZLEVBQ0d3QixRQUFRdkMsR0FDUjZCLE1BQU1SLElBQ0wsTUFBTTVILEVBQVcySixFQUFXLENBQUNwSixLQUFNZ0csRUFBWW9DLE1BQU9sSSxLQUFNOEYsRUFBWXdDLE1BQ3hFVSxFQUFZeEUsUUFBUWpGLEdBQ3BCcUwsRUFBb0I1RixPQUFPLElBRTVCbUUsT0FBT0MsSUFDTkMsUUFBUUMsTUFBTUYsRUFBSSxJQUVuQnVCLFNBQVEsS0FDUEMsRUFBb0IzRSxZQUFXLEVBQU0sR0FFM0MsSUFqQkEyRSxFQUFvQnhGLG9CQW1CcEIsTUFBTXlGLEVBQWtCLElBQUlILEVBQWMsc0JBRzFDLFNBQWdDNUUsR0FDOUIrRSxFQUFnQjVFLFlBQVcsR0FDM0JZLEVBQ0c4QixtQkFBbUI3QyxFQUFZOUYsTUFDL0IySCxNQUFNUixJQUNMb0MsRUFBZ0JVLGNBQWM5QyxFQUFJeUIsUUFDbENpQyxFQUFnQjdGLE9BQU8sSUFFeEJtRSxPQUFPQyxJQUNOQyxRQUFRQyxNQUFNRixFQUFJLElBRW5CdUIsU0FBUSxLQUNQRSxFQUFnQjVFLFlBQVcsRUFBTSxHQUV2QyxJQW9CQSxTQUFTdEcsRUFBZ0JtTCxHQUNqQkEsRUFBSzNLLFFBQ1AwRyxFQUNDNEIsU0FBU3FDLEVBQUs3SyxLQUNkMEgsTUFBTVIsSUFDTDJELEVBQUtuTCxpQkFBaUIsSUFFdkJ3SixPQUFPQyxJQUNOQyxRQUFRQyxNQUFNRixFQUFJLElBR3BCdkMsRUFDQzZCLFdBQVdvQyxFQUFLN0ssS0FDaEIwSCxNQUFNUixJQUNMMkQsRUFBS25MLGlCQUFpQixJQUV2QndKLE9BQU9DLElBQ05DLFFBQVFDLE1BQU1GLEVBQUksR0FHMUIsQ0F4REF5QixFQUFnQnpGLG9CQWtCaEJpQixFQUFrQnJGLGlCQUFpQixTQUFTLEtBQzFDa0osRUFBa0JyRyxrQkFDbEIsTUFBTWtILEVBQVd4QixFQUFnQk8sY0FDakN0RCxFQUFrQlIsTUFBUStFLEVBQVNqTCxLQUNuQ3lHLEVBQXdCUCxNQUFRK0UsRUFBU2hCLElBQ3pDVSxFQUFxQjNGLE1BQU0sSUFJN0I0QixFQUFxQjFGLGlCQUFpQixTQUFTLEtBQzdDNEosRUFBb0I5RixPQUNwQnNGLEVBQWlCdkcsaUJBQWlCLElBR3BDeUMsRUFBb0J0RixpQkFBaUIsU0FBUyxLQUM1QzZKLEVBQWdCL0YsTUFBTSxJQXlCeEIsTUFBTWtHLEVBQWdCLElJdE5QLGNBQW9DckcsRUFDakRyRixXQUFBQSxDQUFZc0YsR0FDVlksTUFBTSxDQUFFWixrQkFDUmhGLEtBQUs2RixXQUFhN0YsS0FBS2lGLGNBQWNuRSxjQUFjLGdCQUNuRGQsS0FBS3dELGNBQWdCeEQsS0FBSzZGLFdBQVcvRSxjQUFjLGlCQUNyRCxDQUVBdUssZUFBQUEsQ0FBZ0IxRixHQUNkM0YsS0FBSzhGLGtCQUFvQkgsQ0FDM0IsQ0FFQVUsVUFBQUEsR0FDTUMsVUFDRnRHLEtBQUt3RCxjQUFjdEIsWUFBYyxjQUVqQ2xDLEtBQUt3RCxjQUFjdEIsWUFBY2xDLEtBQUt1RyxpQkFFMUMsQ0FFQWYsaUJBQUFBLEdBQ0V4RixLQUFLNkYsV0FBV3pFLGlCQUFpQixVQUFXa0UsSUFDMUN0RixLQUFLOEYsbUJBQW1CLElBRTFCRixNQUFNSixtQkFDUixHSjhMOEMseUJBSWhELFNBQVMxRixFQUFrQm9MLEdBQ3pCRSxFQUFjbEcsT0FDZGtHLEVBQWNDLGlCQUFnQixLQUM1QnBFLEVBQ0cwQixXQUFXdUMsRUFBSzdLLEtBQ2hCMEgsTUFBSyxLQUNKbUQsRUFBS3BMLG9CQUNMc0wsRUFBY2hHLE9BQU8sSUFFdEJtRSxPQUFPQyxJQUNOQyxRQUFRQyxNQUFNRixFQUFJLEdBQ2xCLEdBRVIsQ0FoQkE0QixFQUFjNUYsbUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcclxuICB9LFxyXG5cclxuICB7XHJcbiAgICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcclxuICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxyXG4gIH0sXHJcblxyXG4gIHtcclxuICAgICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgfSxcclxuXHJcbiAge1xyXG4gICAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhdGVtYXIuanBnXCIsXHJcbiAgfSxcclxuXHJcbiAge1xyXG4gICAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4gICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcclxuICB9LFxyXG5cclxuICB7XHJcbiAgICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXHJcbiAgfVxyXG5dO1xyXG5cclxuXHJcbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uU2V0dGluZ3MgPSB7XHJcbiAgICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbiAgICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXHJcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcclxuICAgIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gICAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiXHJcbn07XHJcbiIsImNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKGNhcmREYXRhLCBjYXJkU2VsZWN0b3IsIGhhbmRsZVByZXZpZXdQaWN0dXJlLCBoYW5kbGVEZWxldGVDbGljaywgaGFuZGxlTGlrZUNsaWNrKSBcclxuICB7XHJcbiAgICB0aGlzLl9uYW1lID0gY2FyZERhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBjYXJkRGF0YS5saW5rO1xyXG4gICAgdGhpcy5faWQgPSBjYXJkRGF0YS5faWQ7XHJcbiAgICB0aGlzLl9pc0xpa2VkID0gY2FyZERhdGEuaXNMaWtlZFxyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlUHJldmlld1BpY3R1cmUgPSBoYW5kbGVQcmV2aWV3UGljdHVyZTtcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XHJcbiAgfVxyXG4gIFxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZFxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50XHJcbiAgfVxyXG4gIFxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIFxyXG4gICAgdGhpcy5fY2FyZEltYWdlRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlUHJldmlld1BpY3R1cmUodGhpcy5fbmFtZSwgdGhpcy5fbGluaylcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayh0aGlzKTtcclxuICAgIH0pOyBcclxuXHJcbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljaygpO1xyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUxpa2VCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpXHJcbiAgICAgIC5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gIH0gIFxyXG5cclxuICBfdXBkYXRlTGlrZVN0YXR1cygpIHtcclxuICAgIGlmICh0aGlzLl9pc0xpa2VkKSB7XHJcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGhhbmRsZURlbGV0ZUNsaWNrKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xyXG4gIH1cclxuICBcclxuICAgICAgXHJcbiAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICBcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fY2FyZFRpdGxlRWwgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcbiAgICBcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5hbHQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fY2FyZFRpdGxlRWwudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgXHJcbiAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XHJcbiAgIFxyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcclxuICB9IFxyXG4gICAgXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IENhcmQ7IFxyXG4iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zLCBmb3JtRWwpIHtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBvcHRpb25zLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IG9wdGlvbnMuc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gb3B0aW9ucy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gb3B0aW9ucy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gb3B0aW9ucy5lcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZm9ybUVsID0gZm9ybUVsO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpIHtcclxuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7IFxyXG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpIHtcclxuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7IFxyXG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuICBcclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpIHtcclxuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgICB9IFxyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgIHJldHVybiAhdGhpcy5faW5wdXRFbHMuZXZlcnkoKGlucHV0RWwpID0+IGlucHV0RWwudmFsaWRpdHkudmFsaWQpO1xyXG4gIH1cclxuXHJcbiAgZGlzYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpXHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgX2VuYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgfVxyXG4gIFxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQodGhpcy5faW5wdXRFbHMpKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gIFxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW5wdXRFbHMgPSBbLi4udGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcildO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgICBcclxuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHtcclxuICAgICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKGUpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtRWwuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7IFxyXG4gIH1cclxuXHJcbiAgXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7IFxyXG5cclxuICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudClcclxuICB9KTtcclxuICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yOyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihjYXJkRGF0YSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG59IiwiXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH0gXHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkgeyBcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgZXZ0LnRhcmdldCA9PT0gdGhpcy5fcG9wdXBFbGVtZW50IHx8IFxyXG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlXCIpXHJcbiAgICAgICkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSlcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpXHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XHJcbiAgIFxyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICAgIHN1cGVyLmNsb3NlKCk7IFxyXG4gIH1cclxuICBcclxuICBcclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGlucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcclxuICB9IFxyXG5cclxuICBzZXRMb2FkaW5nKGlzTG9hZGluZykge1xyXG4gICAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnV0dG9uVGV4dDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgIH0pO1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEZvcm1cclxuXHJcbi8vaW5kZXguanNcclxuXHJcbi8vIGNvbnN0IG5ld0NhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI3Byb2ZpbGUtYWRkLWNhcmQtbW9kYWxcIiwgKCkgPT4ge30pO1xyXG4vLyBuZXdDYXJkUG9wdXAub3BlblxyXG5cclxuXHJcbi8vIG5ld0NhcmRQb3B1cC5jbG9zZSgpIiwiLy8gSW1wb3J0IGFsbCB0aGUgY2xhc3Nlc1xyXG5pbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcclxuaW1wb3J0IHsgaW5pdGlhbENhcmRzLCB2YWxpZGF0aW9uU2V0dGluZ3MgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmRcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvclwiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uXCI7XHJcbmltcG9ydCBQb3B1cCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFwiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZVwiO1xyXG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvblwiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm9cIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGlcIjtcclxuXHJcblxyXG4vLyBQcm9maWxlIEVkaXRcclxuY29uc3QgcHJvZmlsZUVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIpO1xyXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LWJ1dHRvblwiKTtcclxuY29uc3QgcHJvZmlsZUF2YXRhckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1hdmF0YXItYnV0dG9uXCIpO1xyXG5jb25zdCBwcm9maWxlQ2xvc2VCdXR0b24gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xyXG5jb25zdCBwcm9maWxlRWRpdEZvcm0gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1fZWRpdFwiKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIik7XHJcbmNvbnN0IHByb2ZpbGVUaXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXRpdGxlLWlucHV0XCIpO1xyXG5jb25zdCBwcm9maWxlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RpdGxlXCIpO1xyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xyXG5cclxuXHJcbi8vIEFkZCBDYXJkXHJcbmNvbnN0IHByb2ZpbGVBZGRDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtYWRkLWNhcmQtbW9kYWxcIik7XHJcbmNvbnN0IHByb2ZpbGVBZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWFkZC1idXR0b25cIik7XHJcbmNvbnN0IHByb2ZpbGVBZGRDYXJkQ2xvc2VCdXR0b24gPSBwcm9maWxlQWRkQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xyXG5jb25zdCBhZGRDYXJkRm9ybSA9IHByb2ZpbGVBZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybV9hZGRcIik7XHJcbmNvbnN0IHByb2ZpbGVBZGRDYXJkVGl0bGVJbnB1dCA9IHByb2ZpbGVBZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW5wdXRfdHlwZV90aXRsZVwiKTtcclxuY29uc3QgcHJvZmlsZUFkZENhcmRVcmxJbnB1dCA9IHByb2ZpbGVBZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW5wdXRfdHlwZV91cmxcIik7XHJcblxyXG4vLyBQcmV2aWV3IEltYWdlIE1vZGFsXHJcbmNvbnN0IGltYWdlUHJldmlld01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNpbWFnZS1wcmV2aWV3LW1vZGFsXCIpO1xyXG5jb25zdCBtb2RhbEltYWdlRWxlbWVudCA9IGltYWdlUHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlLXByZXZpZXdcIik7XHJcbmNvbnN0IG1vZGFsQ2FwdGlvbiA9IGltYWdlUHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlLWNhcHRpb25cIik7XHJcbmNvbnN0IGltYWdlUHJldmlld0Nsb3NlQnV0dG9uID0gaW1hZ2VQcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XHJcblxyXG4vLyBDb25maXJtIERlbGV0ZSBNb2RhbFxyXG5jb25zdCB0cmFzaEljb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NvbmZpcm0tZGVsZXRlLW1vZGFsXCIpO1xyXG5jb25zdCB0cmFzaFN1Ym1pdEJ1dHRvbiA9IHRyYXNoSWNvbi5xdWVyeVNlbGVjdG9yKFwiI2NvbmZpcm0tZGVsZXRlLXN1Ym1pdFwiKVxyXG5cclxuLy8gQXZhdGFyIEVkaXQgTW9kYWxcclxuY29uc3QgYXZhdGFyRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItZWRpdC1tb2RhbFwiKTtcclxuXHJcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKS5jb250ZW50LmZpcnN0RWxlbWVudENoaWxkO1xyXG5cclxuXHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCJmMzRmYzk0MC02NDQ0LTRjODQtOTY0My05MTVlODc2ODg5ZmJcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH1cclxufSk7IFxyXG5cclxubGV0IGNhcmRTZWN0aW9uO1xyXG5cclxuYXBpXHJcbiAgLmdldEluaXRpYWxDYXJkcygpXHJcbiAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbih7XHJcbiAgICAgIGl0ZW1zOiByZXMsXHJcbiAgICAgIHJlbmRlcmVyOiAoY2FyZERhdGEpID0+IHtcclxuICAgICAgICBjb25zdCBjYXJkRWwgPSByZW5kZXJDYXJkKGNhcmREYXRhKTtcclxuICAgICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRFbCk7XHJcbiAgICAgIH0sXHJcbiAgICB9LCAgXHJcbiAgXCIuY2FyZHNfX2xpc3RcIlxyXG4gICk7XHJcbiAgXHJcbiAgY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICBjb25zb2xlLmVycm9yKGVycik7IFxyXG4gIH0pO1xyXG4gIFxyXG5jb25zdCBwcm9maWxlVXNlckluZm8gPSBuZXcgVXNlckluZm8oXCIucHJvZmlsZV9fdGl0bGVcIiwgXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIiwgXCIucHJvZmlsZV9faW1hZ2VcIik7ICBcclxuXHJcblxyXG5cclxuXHJcbmNvbnN0IGVkaXRGb3JtRWxlbWVudCA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybV9lZGl0XCIpOyAgXHJcbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBlZGl0Rm9ybUVsZW1lbnQpOyAgXHJcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTsgIFxyXG5cclxuY29uc3QgYXZhdGFyRm9ybUVsZW1lbnQgPSBhdmF0YXJFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybV9hdmF0YXJcIik7ICBcclxuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgYXZhdGFyRm9ybUVsZW1lbnQpOyAgXHJcbmF2YXRhckZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuY29uc3QgYWRkRm9ybUVsZW1lbnQgPSBwcm9maWxlQWRkQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1fYWRkXCIpOyAgXHJcbmNvbnN0IGFkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uU2V0dGluZ3MsIGFkZEZvcm1FbGVtZW50KTsgIFxyXG5hZGRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTsgIFxyXG5cclxuXHJcbmNvbnN0IHBvcHVwV2l0aEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI2ltYWdlLXByZXZpZXctbW9kYWxcIik7ICBcclxucG9wdXBXaXRoSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByZXZpZXdQaWN0dXJlKG5hbWUsIGxpbmspIHtcclxuICBwb3B1cFdpdGhJbWFnZS5vcGVuKG5hbWUsIGxpbmspO1xyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gcmVuZGVyQ2FyZChjYXJkRGF0YSkge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcclxuICAgIGNhcmREYXRhLCBcclxuICAgIFwiI2NhcmQtdGVtcGxhdGVcIixcclxuICAgIGhhbmRsZVByZXZpZXdQaWN0dXJlLFxyXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2ssXHJcbiAgICBoYW5kbGVMaWtlQ2xpY2ssXHJcbiAgKTtcclxuICByZXR1cm4gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxufVxyXG5cclxuY29uc3QgcHJvZmlsZUVkaXRGb3JtUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNwcm9maWxlLWVkaXQtbW9kYWxcIiwgaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQpOyAgXHJcbnByb2ZpbGVFZGl0Rm9ybVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdChpbnB1dFZhbHVlcykge1xyXG4gIHByb2ZpbGVFZGl0Rm9ybVBvcHVwLnNldExvYWRpbmcodHJ1ZSk7XHJcbiAgYXBpXHJcbiAgLmVkaXRQcm9maWxlSW5mbyhpbnB1dFZhbHVlcylcclxuICAudGhlbigocmVzKSA9PiB7XHJcbiAgICBwcm9maWxlVXNlckluZm8uc2V0VXNlckluZm8oaW5wdXRWYWx1ZXMudGl0bGUsIGlucHV0VmFsdWVzLmRlc2NyaXB0aW9uKTtcclxuICAgIHByb2ZpbGVFZGl0Rm9ybVBvcHVwLmNsb3NlKCk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gIH0pXHJcbiAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgcHJvZmlsZUVkaXRGb3JtUG9wdXAuc2V0TG9hZGluZyhmYWxzZSk7XHJcbiAgfSk7XHJcblxyXG59O1xyXG5cclxuY29uc3QgcHJvZmlsZUFkZENhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI3Byb2ZpbGUtYWRkLWNhcmQtbW9kYWxcIiwgaGFuZGxlUHJvZmlsZUFkZENhcmRTdWJtaXQpOyAgXHJcbnByb2ZpbGVBZGRDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVBZGRDYXJkU3VibWl0KGlucHV0VmFsdWVzKSB7XHJcbiAgcHJvZmlsZUFkZENhcmRQb3B1cC5zZXRMb2FkaW5nKHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLmFkZENhcmQoaW5wdXRWYWx1ZXMpXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhcmREYXRhID0gcmVuZGVyQ2FyZCh7bmFtZTogaW5wdXRWYWx1ZXMudGl0bGUsIGxpbms6IGlucHV0VmFsdWVzLnVybCB9KTtcclxuICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRGF0YSk7XHJcbiAgICAgIHByb2ZpbGVBZGRDYXJkUG9wdXAuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBwcm9maWxlQWRkQ2FyZFBvcHVwLnNldExvYWRpbmcoZmFsc2UpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5jb25zdCBhdmF0YXJFZGl0UG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNhdmF0YXItZWRpdC1tb2RhbFwiLCBoYW5kbGVFZGl0QXZhdGFyU3VibWl0KTtcclxuYXZhdGFyRWRpdFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVFZGl0QXZhdGFyU3VibWl0KGlucHV0VmFsdWVzKSB7XHJcbiAgYXZhdGFyRWRpdFBvcHVwLnNldExvYWRpbmcodHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAuZWRpdFByb2ZpbGVQaWN0dXJlKGlucHV0VmFsdWVzLmxpbmspXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHByb2ZpbGVVc2VySW5mby5zZXRVc2VyQXZhdGFyKHJlcy5hdmF0YXIpXHJcbiAgICAgIGF2YXRhckVkaXRQb3B1cC5jbG9zZSgpXHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgYXZhdGFyRWRpdFBvcHVwLnNldExvYWRpbmcoZmFsc2UpO1xyXG4gICAgfSlcclxufVxyXG5cclxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBlZGl0Rm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxuICBjb25zdCB1c2VySW5mbyA9IHByb2ZpbGVVc2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIHByb2ZpbGVUaXRsZUlucHV0LnZhbHVlID0gdXNlckluZm8ubmFtZTtcclxuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHVzZXJJbmZvLmpvYjtcclxuICBwcm9maWxlRWRpdEZvcm1Qb3B1cC5vcGVuKCk7XHJcbiAgXHJcbn0pO1xyXG5cclxucHJvZmlsZUFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBwcm9maWxlQWRkQ2FyZFBvcHVwLm9wZW4oKTtcclxuICBhZGRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuXHJcbnByb2ZpbGVBdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhdmF0YXJFZGl0UG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUxpa2VDbGljayhjYXJkKSB7XHJcbiAgICBpZiAoY2FyZC5pc0xpa2VkKSB7XHJcbiAgICAgIGFwaVxyXG4gICAgICAubGlrZUNhcmQoY2FyZC5faWQpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBjYXJkLmhhbmRsZUxpa2VDbGljaygpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBhcGlcclxuICAgICAgLnVubGlrZUNhcmQoY2FyZC5faWQpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBjYXJkLmhhbmRsZUxpa2VDbGljaygpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgfSlcclxuICAgIH1cclxufSAgXHJcbiAgXHJcbmNvbnN0IGNvbmZpcm1EZWxldGUgPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKFwiI2NvbmZpcm0tZGVsZXRlLW1vZGFsXCIpO1xyXG5jb25maXJtRGVsZXRlLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gIFxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDbGljayhjYXJkKSB7XHJcbiAgY29uZmlybURlbGV0ZS5vcGVuKCk7XHJcbiAgY29uZmlybURlbGV0ZS5zZXRTdWJtaXRBY3Rpb24oKCkgPT4geyAgXHJcbiAgICBhcGlcclxuICAgICAgLmRlbGV0ZUNhcmQoY2FyZC5faWQpXHJcbiAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICBjYXJkLmhhbmRsZURlbGV0ZUNsaWNrKCk7XHJcbiAgICAgICAgY29uZmlybURlbGV0ZS5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgfSlcclxuICAgIH0pO1xyXG59ICAgICAgICAiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxuICBcclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwgXHJcbiAgICB7IGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcclxuICB9O1xyXG5cclxuICBsb2FkVXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyx9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgfTtcclxuXHJcbiAgZWRpdFByb2ZpbGVJbmZvKGNhcmREYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCBcclxuICAgIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBjYXJkRGF0YS50aXRsZSxcclxuICAgICAgICBhYm91dDogY2FyZERhdGEuZGVzY3JpcHRpb24sXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKSAgXHJcbiAgfTtcclxuXHJcbiAgYWRkQ2FyZChpbnB1dFZhbHVlcykge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwgXHJcbiAgICB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBpbnB1dFZhbHVlcy50aXRsZSxcclxuICAgICAgICBsaW5rOiBpbnB1dFZhbHVlcy51cmwsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gIH07XHJcblxyXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwgXHJcbiAgICB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pXHJcbiAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gIH07XHJcblxyXG4gIGxpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIFxyXG4gICAge1xyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KVxyXG4gICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcclxuICB9O1xyXG5cclxuICB1bmxpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIFxyXG4gICAge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KVxyXG4gICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcclxuICB9O1xyXG5cclxuICBlZGl0UHJvZmlsZVBpY3R1cmUobGluaykge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIFxyXG4gICAge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcjogbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpIFxyXG4gIH1cclxuXHJcbiAgbG9hZFBhZ2VDb250ZW50KCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmxvYWRVc2VySW5mbygpLCB0aGlzLmdldEluaXRpYWxDYXJkcygpXSk7XHJcbiAgfVxyXG5cclxuXHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2pvYkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGpvYlNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcclxuICB9XHJcbiAgXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICBjb25zdCB1c2VySW5mbyA9IHtcclxuICAgICAgbmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXHJcbiAgICAgIGpvYjogdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCxcclxuICAgIH07XHJcbiAgICByZXR1cm4gdXNlckluZm87XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyhuYW1lLCBqb2IpIHtcclxuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQgPSBqb2I7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VyQXZhdGFyKGF2YXRhcikge1xyXG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMgPSBhdmF0YXI7XHJcbiAgfVxyXG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSlcclxuICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlLXByZXZpZXdcIik7XHJcbiAgICB0aGlzLl9jYXB0aW9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlLWNhcHRpb25cIik7XHJcbiAgfVxyXG5cclxuXHJcbiAgb3BlbihuYW1lLCBsaW5rKSB7XHJcbiAgICB0aGlzLl9pbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgdGhpcy5faW1hZ2UuYWx0ID0gbmFtZTtcclxuICAgIHRoaXMuX2NhcHRpb24udGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH0gXHJcbn1cclxuXHJcbiAiLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSlcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcclxuICB9XHJcblxyXG4gIHNldFN1Ym1pdEFjdGlvbihoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICB9ICBcclxuXHJcbiAgc2V0TG9hZGluZygpIHtcclxuICAgIGlmIChpc0xvYWRpbmcpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJEZWxldGluZy4uLlwiO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnV0dG9uVGV4dDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KCk7XHJcbiAgICB9KTtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59Il0sIm5hbWVzIjpbInZhbGlkYXRpb25TZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiY29uc3RydWN0b3IiLCJjYXJkRGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZVByZXZpZXdQaWN0dXJlIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJ0aGlzIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2lkIiwiX2lzTGlrZWQiLCJpc0xpa2VkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVQcmV2aWV3UGljdHVyZSIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9oYW5kbGVMaWtlQ2xpY2siLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJjbG9uZU5vZGUiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfY2FyZEltYWdlRWwiLCJhZGRFdmVudExpc3RlbmVyIiwiX2RlbGV0ZUJ1dHRvbiIsIl9lbGVtZW50IiwiX2xpa2VCdXR0b24iLCJfaGFuZGxlTGlrZUJ1dHRvbiIsImNsYXNzTGlzdCIsInRvZ2dsZSIsIl91cGRhdGVMaWtlU3RhdHVzIiwiYWRkIiwicmVtb3ZlIiwiZ2VuZXJhdGVDYXJkIiwiX2NhcmRUaXRsZUVsIiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJvcHRpb25zIiwiZm9ybUVsIiwiX2lucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsIl9mb3JtRWwiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsIiwiZXJyb3JNZXNzYWdlRWwiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGFzSW52YWxpZElucHV0IiwiX2lucHV0RWxzIiwiZXZlcnkiLCJkaXNhYmxlQnV0dG9uIiwiX3N1Ym1pdEJ1dHRvbiIsImRpc2FibGVkIiwiX2VuYWJsZUJ1dHRvbiIsIl90b2dnbGVCdXR0b25TdGF0ZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiZSIsImVuYWJsZVZhbGlkYXRpb24iLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0VmFsaWRhdGlvbiIsImlucHV0RWxlbWVudCIsIlNlY3Rpb24iLCJfcmVmIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIm9wZW4iLCJfaGFuZGxlRXNjQ2xvc2UiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2lucHV0TGlzdCIsInJlc2V0IiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRWYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwic2V0TG9hZGluZyIsImlzTG9hZGluZyIsIl9zdWJtaXRCdXR0b25UZXh0IiwicHJvZmlsZUVkaXRNb2RhbCIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZUF2YXRhckJ1dHRvbiIsInByb2ZpbGVEZXNjcmlwdGlvbklucHV0IiwicHJvZmlsZVRpdGxlSW5wdXQiLCJwcm9maWxlQWRkQ2FyZE1vZGFsIiwicHJvZmlsZUFkZENhcmRCdXR0b24iLCJpbWFnZVByZXZpZXdNb2RhbCIsImF2YXRhckVkaXRNb2RhbCIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsIl9jaGVja1Jlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwidGhlbiIsImxvYWRVc2VySW5mbyIsIm1ldGhvZCIsImVkaXRQcm9maWxlSW5mbyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwidGl0bGUiLCJhYm91dCIsImRlc2NyaXB0aW9uIiwiYWRkQ2FyZCIsInVybCIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJsaWtlQ2FyZCIsInVubGlrZUNhcmQiLCJlZGl0UHJvZmlsZVBpY3R1cmUiLCJhdmF0YXIiLCJsb2FkUGFnZUNvbnRlbnQiLCJhbGwiLCJhdXRob3JpemF0aW9uIiwiY2FyZFNlY3Rpb24iLCJjYXJkRWwiLCJyZW5kZXJDYXJkIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJwcm9maWxlVXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX2pvYkVsZW1lbnQiLCJfYXZhdGFyRWxlbWVudCIsImdldFVzZXJJbmZvIiwiam9iIiwic2V0VXNlckluZm8iLCJzZXRVc2VyQXZhdGFyIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJGb3JtVmFsaWRhdG9yIiwiYWRkRm9ybVZhbGlkYXRvciIsInBvcHVwV2l0aEltYWdlIiwiX2ltYWdlIiwiX2NhcHRpb24iLCJDYXJkIiwicHJvZmlsZUVkaXRGb3JtUG9wdXAiLCJQb3B1cFdpdGhGb3JtIiwiZmluYWxseSIsInByb2ZpbGVBZGRDYXJkUG9wdXAiLCJhdmF0YXJFZGl0UG9wdXAiLCJjYXJkIiwidXNlckluZm8iLCJjb25maXJtRGVsZXRlIiwic2V0U3VibWl0QWN0aW9uIl0sInNvdXJjZVJvb3QiOiIifQ==