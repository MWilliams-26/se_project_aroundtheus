!function(){"use strict";const e=[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}],t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"};var s=class{constructor(e,t,s){this._name=e.name,this._link=e.link,this._cardSelector=t,this._handlePreviewPicture=s}_getTemplate(){return document.querySelector(this._cardSelector).content.firstElementChild.cloneNode(!0)}_setEventListeners(){this._element.querySelector(".card__like-button").addEventListener("click",(()=>this._handleLikeButton())),this._element.querySelector(".card__delete-button").addEventListener("click",(()=>this._handleDeleteButton())),this._element.querySelector(".card__image").addEventListener("click",(()=>this._handlePreviewPicture({name:this._name,link:this._link})))}_handleLikeButton(){this._element.querySelector(".card__like-button").classList.toggle("card__like-button_active")}_handleDeleteButton(){this._element.remove(),this._element=null}generateCard(){return this._element=this._getTemplate(),this._setEventListeners(),this._cardImageEl=this._element.querySelector(".card__image"),this._cardTitleEl=this._element.querySelector(".card__title"),this._cardImageEl.src=this._link,this._cardImageEl.alt=this._name,this._cardTitleEl.textContent=this._name,this._element}},r=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formEl=t}_showInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return!this._inputEls.every((e=>e.validity.valid))}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_toggleButtonState(){this._hasInvalidInput(this._inputEls)?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_setEventListeners(){this._inputEls=[...this._formEl.querySelectorAll(this._inputSelector)],this._submitButton=this._formEl.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formEl.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputEls.forEach((e=>{this._hideInputError(e)}))}};class n{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}class i{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("click",(e=>{(e.target===this._popupElement||e.target.classList.contains("modal__close"))&&this.close()}))}}var o=class extends i{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputList=this._popupForm.querySelectorAll(".modal__input")}close(){this._popupForm.reset(),super.close()}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}};const a=document.querySelector("#profile-edit-modal"),l=document.querySelector("#profile-edit-button"),c=(a.querySelector(".modal__close"),document.forms["edit-profile-form"],document.querySelector("#profile-description-input")),d=document.querySelector("#profile-title-input"),u=(document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector("#profile-add-card-modal")),h=document.querySelector("#profile-add-button"),_=(u.querySelector(".modal__close"),document.forms["add-card-form"],u.querySelector(".modal__input_type_title"),u.querySelector(".modal__input_type_url"),document.querySelector("#image-preview-modal")),m=(_.querySelector(".modal__image-preview"),_.querySelector(".modal__image-caption"),_.querySelector(".modal__close"),document.querySelector("#card-template").content.firstElementChild,new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}loadUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"get",headers:this._headers}).then(this._checkResponse)}editProfileInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:title,about:description})}).then(this._checkResponse)}addCard(){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:title,link:url})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/_id`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}likeCard(){return fetch(`${this._baseUrl}/cards/_id/likes`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}unlikeCard(){return fetch(`${this._baseUrl}/cards/_id`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}unlikeCard(){return fetch(`${this._baseUrl}/cards/_id`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}editProfilePicture(){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:link})}).then(this._checkResponse)}loadPageContent(){return Promise.all([this.loadUserInfo(),this.getInitialCards()])}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"f34fc940-6444-4c84-9643-915e876889fb","Content-Type":"application/json"}}));let p;const E=new class{constructor(e,t){this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo(e,t){this._nameElement.textContent=e,this._jobElement.textContent=t}}(".profile__title",".profile__description");m.loadPageContent().then((t=>{p=new n({items:e,renderer:e=>{const t=L(e);p.addItem(t)}},".cards__list"),p.renderItems()})).catch((e=>{console.error(e)}));const f=new o("#profile-edit-modal",(function(e){E.setUserInfo(e.title,e.description),f.close()}));f.setEventListeners();const v=document.forms["edit-profile-form"],b=new r(t,v);b.enableValidation();const S=new o("#profile-add-card-modal",(function(e){const t=L({name:e.title,link:e.url});p.addItem(t),S.close()}));S.setEventListeners();const y=document.forms["add-card-form"],g=new r(t,y);g.enableValidation();const k=new class extends i{constructor(e){super({popupSelector:e}),this._image=this._popupElement.querySelector(".modal__image-preview"),this._caption=this._popupElement.querySelector(".modal__image-caption")}open(e,t){this._image.src=t,this._image.alt=e,this._caption.textContent=e,super.open()}}("#image-preview-modal");k.setEventListeners();const C={};function L(e){return new s(e,"#card-template",(()=>{k.open(e.name,e.link)})).generateCard()}(e=>{Array.from(document.querySelectorAll(e.formSelector)).forEach((t=>{const s=new r(e,t),n=t.getAttribute("name");C[n]=s,s.enableValidation()}))})(t),l.addEventListener("click",(()=>{b.resetValidation();const e=E.getUserInfo();d.value=e.name,c.value=e.job,f.open()})),h.addEventListener("click",(()=>{S.open(),g.resetValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFDaEIsTUFBTUMsRUFBWSxJQUFJWixFQUFjckssRUFBb0JnTCxHQUNsREUsRUFBV0YsRUFBWUcsYUFBYSxRQUUxQ1AsRUFBZU0sR0FBWUQsRUFDNUJBLEVBQVVoSCxrQkFBa0IsR0FDM0IsRUFHSkEsQ0FBaUJqRSxHQXVCakJ3RyxFQUFrQmhGLGlCQUFpQixTQUFTLEtBQzFDNEksRUFBa0JqRyxrQkFDbEIsTUFBTWlILEVBQVdqQyxFQUFnQkssY0FDakM3QyxFQUFrQkwsTUFBUThFLEVBQVN0TCxLQUNuQzJHLEVBQXdCSCxNQUFROEUsRUFBUzNCLElBQ3pDUSxFQUFxQjdFLE1BQU0sSUFJN0J5QixFQUFxQnJGLGlCQUFpQixTQUFTLEtBQzdDOEksRUFBb0JsRixPQUNwQm9GLEVBQWlCckcsaUJBQWlCLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxyXG4gIH0sXHJcblxyXG4gIHtcclxuICAgICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgfSxcclxuXHJcbiAge1xyXG4gICAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9iYWxkLW1vdW50YWlucy5qcGdcIixcclxuICB9LFxyXG5cclxuICB7XHJcbiAgICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxyXG4gICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcclxuICB9LFxyXG5cclxuICB7XHJcbiAgICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxyXG4gIH0sXHJcblxyXG4gIHtcclxuICAgICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcclxuICB9XHJcbl07XHJcblxyXG5cclxuZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25TZXR0aW5ncyA9IHtcclxuICAgIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICAgIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcclxuICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gICAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCJcclxufTtcclxuIiwiY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoY2FyZERhdGEsIGNhcmRTZWxlY3RvciwgaGFuZGxlUHJldmlld1BpY3R1cmUpIHtcclxuICAgIHRoaXMuX25hbWUgPSBjYXJkRGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGNhcmREYXRhLmxpbms7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVQcmV2aWV3UGljdHVyZSA9IGhhbmRsZVByZXZpZXdQaWN0dXJlO1xyXG4gIH1cclxuICBcclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGRcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuICAgIHJldHVybiBjYXJkRWxlbWVudFxyXG4gIH1cclxuICBcclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlTGlrZUJ1dHRvbigpKTtcclxuXHJcbiAgICB0aGlzLl9lbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVEZWxldGVCdXR0b24oKSk7XHJcblxyXG4gICAgdGhpcy5fZWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZVByZXZpZXdQaWN0dXJlKHsgbmFtZTogdGhpcy5fbmFtZSwgbGluazogdGhpcy5fbGluayB9KSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlTGlrZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX2VsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcclxuICAgICAgLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRGVsZXRlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xyXG4gIH1cclxuICAgICAgXHJcbiAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fY2FyZFRpdGxlRWwgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcbiAgICBcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5hbHQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fY2FyZFRpdGxlRWwudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gIH0gICAgXHJcbiAgICBcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQ2FyZDsgXHJcbiIsImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMsIGZvcm1FbCkge1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IG9wdGlvbnMuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gb3B0aW9ucy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBvcHRpb25zLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBvcHRpb25zLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBvcHRpb25zLmVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9mb3JtRWwgPSBmb3JtRWw7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbCkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTsgXHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbCkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTsgXHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG4gIFxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCkge1xyXG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcclxuICAgIH0gXHJcbiAgfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuICF0aGlzLl9pbnB1dEVscy5ldmVyeSgoaW5wdXRFbCkgPT4gaW5wdXRFbC52YWxpZGl0eS52YWxpZCk7XHJcbiAgfVxyXG5cclxuICBkaXNhYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcylcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgfVxyXG5cclxuICBfZW5hYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICB9XHJcbiAgXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dEVscykpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dEVscyA9IFsuLi50aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKV07XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgICAgIFxyXG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoZSkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm1FbC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTsgXHJcbiAgfVxyXG5cclxuICBcclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTsgXHJcblxyXG4gIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KVxyXG4gIH0pO1xyXG4gIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICByZW5kZXJJdGVtcygpIHtcclxuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGNhcmREYXRhKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGNhcmREYXRhKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn0iLCJcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfSBcclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT4ge1xyXG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7IFxyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGlmIChcclxuICAgICAgICBldnQudGFyZ2V0ID09PSB0aGlzLl9wb3B1cEVsZW1lbnQgfHwgXHJcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2VcIilcclxuICAgICAgKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5jbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KVxyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIilcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICAgIHN1cGVyLmNsb3NlKCk7IFxyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9KTtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhGb3JtXHJcblxyXG4vL2luZGV4LmpzXHJcblxyXG4vLyBjb25zdCBuZXdDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNwcm9maWxlLWFkZC1jYXJkLW1vZGFsXCIsICgpID0+IHt9KTtcclxuLy8gbmV3Q2FyZFBvcHVwLm9wZW5cclxuXHJcblxyXG4vLyBuZXdDYXJkUG9wdXAuY2xvc2UoKSIsIi8vIEltcG9ydCBhbGwgdGhlIGNsYXNzZXNcclxuaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XHJcbmltcG9ydCB7IGluaXRpYWxDYXJkcywgdmFsaWRhdGlvblNldHRpbmdzIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50c1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3JcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvblwiO1xyXG5pbXBvcnQgUG9wdXAgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybVwiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2VcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpXCI7XHJcblxyXG5cclxuLy8gUHJvZmlsZSBFZGl0XHJcbmNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiKTtcclxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XHJcbmNvbnN0IHByb2ZpbGVDbG9zZUJ1dHRvbiA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XHJcbmNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiZWRpdC1wcm9maWxlLWZvcm1cIl07XHJcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCIpO1xyXG5jb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZS1pbnB1dFwiKTtcclxuY29uc3QgcHJvZmlsZVRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX190aXRsZVwiKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcclxuXHJcblxyXG4vLyBBZGQgQ2FyZFxyXG5jb25zdCBwcm9maWxlQWRkQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWFkZC1jYXJkLW1vZGFsXCIpO1xyXG5jb25zdCBwcm9maWxlQWRkQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1hZGQtYnV0dG9uXCIpO1xyXG5jb25zdCBwcm9maWxlQWRkQ2FyZENsb3NlQnV0dG9uID0gcHJvZmlsZUFkZENhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcclxuY29uc3QgYWRkQ2FyZEZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcImFkZC1jYXJkLWZvcm1cIl07XHJcbmNvbnN0IHByb2ZpbGVBZGRDYXJkVGl0bGVJbnB1dCA9IHByb2ZpbGVBZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW5wdXRfdHlwZV90aXRsZVwiKTtcclxuY29uc3QgcHJvZmlsZUFkZENhcmRVcmxJbnB1dCA9IHByb2ZpbGVBZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW5wdXRfdHlwZV91cmxcIik7XHJcblxyXG4vLyBQcmV2aWV3IEltYWdlIE1vZGFsXHJcbmNvbnN0IGltYWdlUHJldmlld01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNpbWFnZS1wcmV2aWV3LW1vZGFsXCIpO1xyXG5jb25zdCBtb2RhbEltYWdlRWxlbWVudCA9IGltYWdlUHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlLXByZXZpZXdcIik7XHJcbmNvbnN0IG1vZGFsQ2FwdGlvbiA9IGltYWdlUHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlLWNhcHRpb25cIik7XHJcbmNvbnN0IGltYWdlUHJldmlld0Nsb3NlQnV0dG9uID0gaW1hZ2VQcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XHJcblxyXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIikuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZDtcclxuXHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCJmMzRmYzk0MC02NDQ0LTRjODQtOTY0My05MTVlODc2ODg5ZmJcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgfVxyXG59KTsgXHJcblxyXG5sZXQgY2FyZFNlY3Rpb247XHJcblxyXG5jb25zdCBwcm9maWxlVXNlckluZm8gPSBuZXcgVXNlckluZm8oXCIucHJvZmlsZV9fdGl0bGVcIiwgXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XHJcblxyXG5hcGlcclxuICAubG9hZFBhZ2VDb250ZW50KClcclxuICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oe1xyXG4gICAgaXRlbXM6IGluaXRpYWxDYXJkcyxcclxuICAgIHJlbmRlcmVyOiAoY2FyZERhdGEpID0+IHtcclxuICAgICAgY29uc3QgY2FyZEVsID0gcmVuZGVyQ2FyZChjYXJkRGF0YSk7XHJcbiAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsKTtcclxuICAgIH0sXHJcbiAgfSwgIFxyXG4gIFwiLmNhcmRzX19saXN0XCJcclxuICApO1xyXG4gIFxyXG4gIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gIGNvbnNvbGUuZXJyb3IoZXJyKTsgXHJcbiAgfSk7XHJcbiAgXHJcblxyXG5jb25zdCBwcm9maWxlRWRpdEZvcm1Qb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLCBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdCk7XHJcbnByb2ZpbGVFZGl0Rm9ybVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBlZGl0Rm9ybUVsZW1lbnQgPSBkb2N1bWVudC5mb3Jtc1tcImVkaXQtcHJvZmlsZS1mb3JtXCJdO1xyXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgZWRpdEZvcm1FbGVtZW50KTtcclxuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuY29uc3QgcHJvZmlsZUFkZENhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI3Byb2ZpbGUtYWRkLWNhcmQtbW9kYWxcIiwgaGFuZGxlUHJvZmlsZUFkZENhcmRTdWJtaXQpO1xyXG5wcm9maWxlQWRkQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBhZGRGb3JtRWxlbWVudCA9IGRvY3VtZW50LmZvcm1zW1wiYWRkLWNhcmQtZm9ybVwiXTtcclxuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgYWRkRm9ybUVsZW1lbnQpO1xyXG5hZGRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcblxyXG5jb25zdCBwb3B1cFdpdGhJbWFnZSA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNpbWFnZS1wcmV2aWV3LW1vZGFsXCIpO1xyXG5wb3B1cFdpdGhJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgZm9ybVZhbGlkYXRvcnMgPSB7fVxyXG5cclxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9ICh2YWxpZGF0aW9uU2V0dGluZ3MpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh2YWxpZGF0aW9uU2V0dGluZ3MuZm9ybVNlbGVjdG9yKSlcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBmb3JtRWxlbWVudClcclxuICAgIGNvbnN0IGZvcm1OYW1lID0gZm9ybUVsZW1lbnQuZ2V0QXR0cmlidXRlKFwibmFtZVwiKVxyXG4gICBcclxuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcclxuICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuICB9KTtcclxufTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24odmFsaWRhdGlvblNldHRpbmdzKTtcclxuXHJcblxyXG5mdW5jdGlvbiByZW5kZXJDYXJkKGNhcmREYXRhKSB7XHJcbiAgcmV0dXJuIG5ldyBDYXJkKGNhcmREYXRhLCBcIiNjYXJkLXRlbXBsYXRlXCIsICgpID0+IHtcclxuICAgIHBvcHVwV2l0aEltYWdlLm9wZW4oY2FyZERhdGEubmFtZSwgY2FyZERhdGEubGluaylcclxuICB9KVxyXG4gIC5nZW5lcmF0ZUNhcmQoKTtcclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0KGlucHV0VmFsdWVzKSB7XHJcbiAgcHJvZmlsZVVzZXJJbmZvLnNldFVzZXJJbmZvKGlucHV0VmFsdWVzLnRpdGxlLCBpbnB1dFZhbHVlcy5kZXNjcmlwdGlvbik7XHJcbiAgcHJvZmlsZUVkaXRGb3JtUG9wdXAuY2xvc2UoKTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVBZGRDYXJkU3VibWl0KGlucHV0VmFsdWVzKSB7XHJcbiAgY29uc3QgY2FyZERhdGEgPSByZW5kZXJDYXJkKHtuYW1lOiBpbnB1dFZhbHVlcy50aXRsZSwgbGluazogaW5wdXRWYWx1ZXMudXJsIH0pO1xyXG4gIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZERhdGEpO1xyXG4gIHByb2ZpbGVBZGRDYXJkUG9wdXAuY2xvc2UoKTtcclxuICBcclxufTtcclxuIFxyXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGVkaXRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGNvbnN0IHVzZXJJbmZvID0gcHJvZmlsZVVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgcHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSB1c2VySW5mby5uYW1lO1xyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gdXNlckluZm8uam9iO1xyXG4gIHByb2ZpbGVFZGl0Rm9ybVBvcHVwLm9wZW4oKTtcclxuICBcclxufSk7XHJcblxyXG5wcm9maWxlQWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHByb2ZpbGVBZGRDYXJkUG9wdXAub3BlbigpO1xyXG4gIGFkZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn0pOyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG4gIFxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCBcclxuICAgIHsgaGVhZGVyczogdGhpcy5faGVhZGVycywgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gIH07XHJcblxyXG4gIGxvYWRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIFxyXG4gICAge1xyXG4gICAgICBtZXRob2Q6IFwiZ2V0XCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gIH07XHJcblxyXG4gIGVkaXRQcm9maWxlSW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIFxyXG4gICAge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IHRpdGxlLFxyXG4gICAgICAgIGFib3V0OiBkZXNjcmlwdGlvbixcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpICBcclxuICB9O1xyXG5cclxuICBhZGRDYXJkKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwgXHJcbiAgICB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiB0aXRsZSxcclxuICAgICAgICBsaW5rOiB1cmwsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gIH07XHJcblxyXG4gIGRlbGV0ZUNhcmQoX2lkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvX2lkYCwgXHJcbiAgICB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pXHJcbiAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gIH07XHJcblxyXG4gIGxpa2VDYXJkKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL19pZC9saWtlc2AsIFxyXG4gICAge1xyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KVxyXG4gICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcclxuICB9O1xyXG5cclxuICB1bmxpa2VDYXJkKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL19pZGAsIFxyXG4gICAge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KVxyXG4gICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcclxuICB9O1xyXG5cclxuICB1bmxpa2VDYXJkKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL19pZGAsIFxyXG4gICAge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KVxyXG4gICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcclxuICB9O1xyXG5cclxuICBlZGl0UHJvZmlsZVBpY3R1cmUoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwgXHJcbiAgICB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyOiBsaW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSkgXHJcbiAgfVxyXG5cclxuICBsb2FkUGFnZUNvbnRlbnQoKSB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMubG9hZFVzZXJJbmZvKCksIHRoaXMuZ2V0SW5pdGlhbENhcmRzKCldKTtcclxuICB9XHJcblxyXG5cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IobmFtZVNlbGVjdG9yLCBqb2JTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9qb2JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XHJcbiAgfVxyXG4gIFxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgY29uc3QgdXNlckluZm8gPSB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgICBqb2I6IHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQsXHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIHVzZXJJbmZvO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8obmFtZSwgam9iKSB7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50ID0gam9iO1xyXG4gIH1cclxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pXHJcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZS1wcmV2aWV3XCIpO1xyXG4gICAgdGhpcy5fY2FwdGlvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZS1jYXB0aW9uXCIpO1xyXG4gIH1cclxuXHJcblxyXG4gIG9wZW4obmFtZSwgbGluaykge1xyXG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gbGluaztcclxuICAgIHRoaXMuX2ltYWdlLmFsdCA9IG5hbWU7XHJcbiAgICB0aGlzLl9jYXB0aW9uLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9IFxyXG59XHJcblxyXG4gIl0sIm5hbWVzIjpbImluaXRpYWxDYXJkcyIsIm5hbWUiLCJsaW5rIiwidmFsaWRhdGlvblNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJjb25zdHJ1Y3RvciIsImNhcmREYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlUHJldmlld1BpY3R1cmUiLCJ0aGlzIiwiX25hbWUiLCJfbGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlUHJldmlld1BpY3R1cmUiLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJjbG9uZU5vZGUiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfZWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlTGlrZUJ1dHRvbiIsIl9oYW5kbGVEZWxldGVCdXR0b24iLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJyZW1vdmUiLCJnZW5lcmF0ZUNhcmQiLCJfY2FyZEltYWdlRWwiLCJfY2FyZFRpdGxlRWwiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsIm9wdGlvbnMiLCJmb3JtRWwiLCJfaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiX2Zvcm1FbCIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWwiLCJlcnJvck1lc3NhZ2VFbCIsImlkIiwiYWRkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfaW5wdXRFbHMiLCJldmVyeSIsImRpc2FibGVCdXR0b24iLCJfc3VibWl0QnV0dG9uIiwiZGlzYWJsZWQiLCJfZW5hYmxlQnV0dG9uIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJlIiwiZW5hYmxlVmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwicmVzZXRWYWxpZGF0aW9uIiwiaW5wdXRFbGVtZW50IiwiU2VjdGlvbiIsIl9yZWYiLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50Iiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2dCIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfaW5wdXRMaXN0IiwicmVzZXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJwcm9maWxlRWRpdE1vZGFsIiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlRGVzY3JpcHRpb25JbnB1dCIsImZvcm1zIiwicHJvZmlsZVRpdGxlSW5wdXQiLCJwcm9maWxlQWRkQ2FyZE1vZGFsIiwicHJvZmlsZUFkZENhcmRCdXR0b24iLCJpbWFnZVByZXZpZXdNb2RhbCIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsIl9jaGVja1Jlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwidGhlbiIsImxvYWRVc2VySW5mbyIsIm1ldGhvZCIsImVkaXRQcm9maWxlSW5mbyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwidGl0bGUiLCJhYm91dCIsImRlc2NyaXB0aW9uIiwiYWRkQ2FyZCIsInVybCIsImRlbGV0ZUNhcmQiLCJfaWQiLCJsaWtlQ2FyZCIsInVubGlrZUNhcmQiLCJlZGl0UHJvZmlsZVBpY3R1cmUiLCJhdmF0YXIiLCJsb2FkUGFnZUNvbnRlbnQiLCJhbGwiLCJhdXRob3JpemF0aW9uIiwiY2FyZFNlY3Rpb24iLCJwcm9maWxlVXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsIl9uYW1lRWxlbWVudCIsIl9qb2JFbGVtZW50IiwiZ2V0VXNlckluZm8iLCJqb2IiLCJzZXRVc2VySW5mbyIsImNhcmRFbCIsInJlbmRlckNhcmQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsInByb2ZpbGVFZGl0Rm9ybVBvcHVwIiwiUG9wdXBXaXRoRm9ybSIsImVkaXRGb3JtRWxlbWVudCIsImVkaXRGb3JtVmFsaWRhdG9yIiwiRm9ybVZhbGlkYXRvciIsInByb2ZpbGVBZGRDYXJkUG9wdXAiLCJhZGRGb3JtRWxlbWVudCIsImFkZEZvcm1WYWxpZGF0b3IiLCJwb3B1cFdpdGhJbWFnZSIsIl9pbWFnZSIsIl9jYXB0aW9uIiwiZm9ybVZhbGlkYXRvcnMiLCJDYXJkIiwiQXJyYXkiLCJmcm9tIiwiZm9ybUVsZW1lbnQiLCJ2YWxpZGF0b3IiLCJmb3JtTmFtZSIsImdldEF0dHJpYnV0ZSIsInVzZXJJbmZvIl0sInNvdXJjZVJvb3QiOiIifQ==